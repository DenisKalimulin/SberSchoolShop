2025-03-06 13:30:04 | INFO  | o.h.validator.internal.util.Version | HV000001: Hibernate Validator 8.0.2.Final
2025-03-06 13:30:04 | INFO  | ru.kalimulin.SberSchoolShop | Starting SberSchoolShop using Java 17.0.11 with PID 64754 (/Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop/web/target/classes started by deniskalimulin in /Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop)
2025-03-06 13:30:04 | INFO  | ru.kalimulin.SberSchoolShop | No active profile set, falling back to 1 default profile: "default"
2025-03-06 13:30:04 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-06 13:30:04 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Finished Spring Data repository scanning in 41 ms. Found 13 JPA repository interfaces.
2025-03-06 13:30:05 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat initialized with port 8080 (http)
2025-03-06 13:30:05 | INFO  | o.a.coyote.http11.Http11NioProtocol | Initializing ProtocolHandler ["http-nio-8080"]
2025-03-06 13:30:05 | INFO  | o.a.catalina.core.StandardService | Starting service [Tomcat]
2025-03-06 13:30:05 | INFO  | o.a.catalina.core.StandardEngine | Starting Servlet engine: [Apache Tomcat/10.1.34]
2025-03-06 13:30:05 | INFO  | o.a.c.c.C.[Tomcat].[localhost].[/] | Initializing Spring embedded WebApplicationContext
2025-03-06 13:30:05 | INFO  | o.s.b.w.s.c.ServletWebServerApplicationContext | Root WebApplicationContext: initialization completed in 1103 ms
2025-03-06 13:30:05 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Starting...
2025-03-06 13:30:06 | INFO  | com.zaxxer.hikari.pool.HikariPool | HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@6ad6ae45
2025-03-06 13:30:06 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Start completed.
2025-03-06 13:30:06 | INFO  | o.h.jpa.internal.util.LogHelper | HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-06 13:30:07 | INFO  | org.hibernate.Version | HHH000412: Hibernate ORM core version 6.6.5.Final
2025-03-06 13:30:07 | INFO  | o.h.c.i.RegionFactoryInitiator | HHH000026: Second-level cache disabled
2025-03-06 13:30:07 | INFO  | o.s.o.j.p.SpringPersistenceUnitInfo | No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-06 13:30:07 | WARN  | org.hibernate.orm.deprecation | HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-06 13:30:07 | INFO  | o.hibernate.orm.connections.pooling | HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.3
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-06 13:30:08 | INFO  | o.h.e.t.j.p.i.JtaPlatformInitiator | HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-06 13:30:08 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 13:30:08 | INFO  | o.s.d.j.r.query.QueryEnhancerFactory | Hibernate is in classpath; If applicable, HQL parser will be used.
2025-03-06 13:30:09 | INFO  | o.a.coyote.http11.Http11NioProtocol | Starting ProtocolHandler ["http-nio-8080"]
2025-03-06 13:30:09 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat started on port 8080 (http) with context path '/'
2025-03-06 13:30:09 | INFO  | o.a.k.c.consumer.ConsumerConfig | ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-03-06 13:30:09 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 13:30:09 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 13:30:09 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 13:30:09 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741257009405
2025-03-06 13:30:09 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Subscribed to topic(s): email-notifications
2025-03-06 13:30:09 | INFO  | ru.kalimulin.SberSchoolShop | Started SberSchoolShop in 5.747 seconds (process running for 6.387)
2025-03-06 13:30:09 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cluster ID: rzT2QuncR2u6PaURJqk5_g
2025-03-06 13:30:09 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-03-06 13:30:09 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 13:30:09 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: need to re-join with the given member-id: consumer-email-group-1-1eb1ac04-b629-4351-8eb5-63f75407486a
2025-03-06 13:30:09 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 13:30:12 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully joined group with generation Generation{generationId=23, memberId='consumer-email-group-1-1eb1ac04-b629-4351-8eb5-63f75407486a', protocol='range'}
2025-03-06 13:30:12 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Finished assignment for group at generation 23: {consumer-email-group-1-1eb1ac04-b629-4351-8eb5-63f75407486a=Assignment(partitions=[email-notifications-0])}
2025-03-06 13:30:12 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully synced group in generation Generation{generationId=23, memberId='consumer-email-group-1-1eb1ac04-b629-4351-8eb5-63f75407486a', protocol='range'}
2025-03-06 13:30:12 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Notifying assignor about the new Assignment(partitions=[email-notifications-0])
2025-03-06 13:30:12 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Adding newly assigned partitions: email-notifications-0
2025-03-06 13:30:12 | INFO  | o.a.k.c.c.internals.ConsumerUtils | Setting offset for partition email-notifications-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-03-06 13:30:12 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions assigned: [email-notifications-0]
2025-03-06 13:30:34 | INFO  | o.a.c.c.C.[Tomcat].[localhost].[/] | Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-03-06 13:30:34 | INFO  | o.s.web.servlet.DispatcherServlet | Initializing Servlet 'dispatcherServlet'
2025-03-06 13:30:34 | INFO  | o.s.web.servlet.DispatcherServlet | Completed initialization in 1 ms
2025-03-06 13:30:34 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/login | RequestID=6a607613-1031-4482-9c16-e94da51fe6c2 | Время=2025-03-06T10:30:34.608550Z | Операция=LOGIN_USER
2025-03-06 13:30:34 | INFO  | r.k.serviceImpl.UserServiceImpl | Попытка входа пользователя:
2025-03-06 13:30:35 | INFO  | r.k.serviceImpl.UserServiceImpl | Успешный вход
2025-03-06 13:30:35 | INFO  | r.k.controllers.AuthController | Пользователь вошел в систему
2025-03-06 13:30:35 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/login | RequestID=6a607613-1031-4482-9c16-e94da51fe6c2 | Время=2025-03-06T10:30:34.608550Z | Длительность=721мс | Операция=LOGIN_USER | Статус=200
2025-03-06 13:30:38 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Revoke previously assigned partitions email-notifications-0
2025-03-06 13:30:38 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions revoked: [email-notifications-0]
2025-03-06 13:30:38 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Member consumer-email-group-1-1eb1ac04-b629-4351-8eb5-63f75407486a sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-03-06 13:30:38 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 13:30:38 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 13:30:38 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Unsubscribed all topics or patterns and assigned partitions
2025-03-06 13:30:38 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 13:30:38 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 13:30:39 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 13:30:39 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 13:30:39 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 13:30:39 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 13:30:39 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.consumer for consumer-email-group-1 unregistered
2025-03-06 13:30:39 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: Consumer stopped
2025-03-06 13:30:39 | INFO  | o.s.b.w.e.tomcat.GracefulShutdown | Commencing graceful shutdown. Waiting for active requests to complete
2025-03-06 13:30:39 | INFO  | o.s.b.w.e.tomcat.GracefulShutdown | Graceful shutdown complete
2025-03-06 13:30:39 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 13:30:39 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown initiated...
2025-03-06 13:30:39 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown completed.
2025-03-06 15:05:14 | INFO  | o.h.validator.internal.util.Version | HV000001: Hibernate Validator 8.0.2.Final
2025-03-06 15:05:14 | INFO  | ru.kalimulin.SberSchoolShop | Starting SberSchoolShop using Java 17.0.11 with PID 69839 (/Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop/web/target/classes started by deniskalimulin in /Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop)
2025-03-06 15:05:14 | INFO  | ru.kalimulin.SberSchoolShop | No active profile set, falling back to 1 default profile: "default"
2025-03-06 15:05:15 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-06 15:05:15 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Finished Spring Data repository scanning in 62 ms. Found 13 JPA repository interfaces.
2025-03-06 15:05:16 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat initialized with port 8080 (http)
2025-03-06 15:05:16 | INFO  | o.a.coyote.http11.Http11NioProtocol | Initializing ProtocolHandler ["http-nio-8080"]
2025-03-06 15:05:16 | INFO  | o.a.catalina.core.StandardService | Starting service [Tomcat]
2025-03-06 15:05:16 | INFO  | o.a.catalina.core.StandardEngine | Starting Servlet engine: [Apache Tomcat/10.1.34]
2025-03-06 15:05:16 | INFO  | o.a.c.c.C.[Tomcat].[localhost].[/] | Initializing Spring embedded WebApplicationContext
2025-03-06 15:05:16 | INFO  | o.s.b.w.s.c.ServletWebServerApplicationContext | Root WebApplicationContext: initialization completed in 1399 ms
2025-03-06 15:05:16 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Starting...
2025-03-06 15:05:18 | INFO  | com.zaxxer.hikari.pool.HikariPool | HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1da75dde
2025-03-06 15:05:18 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Start completed.
2025-03-06 15:05:18 | INFO  | o.h.jpa.internal.util.LogHelper | HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-06 15:05:18 | INFO  | org.hibernate.Version | HHH000412: Hibernate ORM core version 6.6.5.Final
2025-03-06 15:05:18 | INFO  | o.h.c.i.RegionFactoryInitiator | HHH000026: Second-level cache disabled
2025-03-06 15:05:18 | INFO  | o.s.o.j.p.SpringPersistenceUnitInfo | No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-06 15:05:18 | WARN  | org.hibernate.orm.deprecation | HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-06 15:05:18 | INFO  | o.hibernate.orm.connections.pooling | HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.3
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-06 15:05:19 | INFO  | o.h.e.t.j.p.i.JtaPlatformInitiator | HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-06 15:05:19 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 15:05:20 | INFO  | o.s.d.j.r.query.QueryEnhancerFactory | Hibernate is in classpath; If applicable, HQL parser will be used.
2025-03-06 15:05:21 | INFO  | o.a.coyote.http11.Http11NioProtocol | Starting ProtocolHandler ["http-nio-8080"]
2025-03-06 15:05:21 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat started on port 8080 (http) with context path '/'
2025-03-06 15:05:21 | INFO  | o.a.k.c.consumer.ConsumerConfig | ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-03-06 15:05:21 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 15:05:21 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 15:05:21 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 15:05:21 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741262721394
2025-03-06 15:05:21 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Subscribed to topic(s): email-notifications
2025-03-06 15:05:21 | INFO  | ru.kalimulin.SberSchoolShop | Started SberSchoolShop in 7.198 seconds (process running for 7.72)
2025-03-06 15:05:21 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cluster ID: rzT2QuncR2u6PaURJqk5_g
2025-03-06 15:05:21 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-03-06 15:05:21 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 15:05:21 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: need to re-join with the given member-id: consumer-email-group-1-eebb9a3a-338e-425f-82c8-ea8b0e66e418
2025-03-06 15:05:21 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 15:05:25 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully joined group with generation Generation{generationId=25, memberId='consumer-email-group-1-eebb9a3a-338e-425f-82c8-ea8b0e66e418', protocol='range'}
2025-03-06 15:05:25 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Finished assignment for group at generation 25: {consumer-email-group-1-eebb9a3a-338e-425f-82c8-ea8b0e66e418=Assignment(partitions=[email-notifications-0])}
2025-03-06 15:05:25 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully synced group in generation Generation{generationId=25, memberId='consumer-email-group-1-eebb9a3a-338e-425f-82c8-ea8b0e66e418', protocol='range'}
2025-03-06 15:05:25 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Notifying assignor about the new Assignment(partitions=[email-notifications-0])
2025-03-06 15:05:25 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Adding newly assigned partitions: email-notifications-0
2025-03-06 15:05:25 | INFO  | o.a.k.c.c.internals.ConsumerUtils | Setting offset for partition email-notifications-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-03-06 15:05:25 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions assigned: [email-notifications-0]
2025-03-06 15:05:54 | INFO  | o.a.c.c.C.[Tomcat].[localhost].[/] | Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-03-06 15:05:54 | INFO  | o.s.web.servlet.DispatcherServlet | Initializing Servlet 'dispatcherServlet'
2025-03-06 15:05:54 | INFO  | o.s.web.servlet.DispatcherServlet | Completed initialization in 14 ms
2025-03-06 15:05:54 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/register | RequestID=44afc7df-3494-483e-bbdd-de39f9d314f7 | Время=2025-03-06T12:05:54.279367Z | Операция=REGISTER_USER
2025-03-06 15:05:54 | INFO  | r.k.serviceImpl.UserServiceImpl | Регистрация нового пользователя
2025-03-06 15:05:54 | WARN  | r.k.serviceImpl.UserServiceImpl | Попытка регистрации с уже существующим логином
2025-03-06 15:05:55 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/register | RequestID=44afc7df-3494-483e-bbdd-de39f9d314f7 | Время=2025-03-06T12:05:54.279367Z | Длительность=739мс | Операция=REGISTER_USER | Статус=400
2025-03-06 15:06:02 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/register | RequestID=d699eb04-0a6d-43d3-8fed-de69acf8359b | Время=2025-03-06T12:06:02.309806Z | Операция=REGISTER_USER
2025-03-06 15:06:02 | INFO  | r.k.serviceImpl.UserServiceImpl | Регистрация нового пользователя
2025-03-06 15:06:02 | WARN  | r.k.serviceImpl.UserServiceImpl | Попытка регистрации с уже существующим логином
2025-03-06 15:06:02 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/register | RequestID=d699eb04-0a6d-43d3-8fed-de69acf8359b | Время=2025-03-06T12:06:02.309806Z | Длительность=29мс | Операция=REGISTER_USER | Статус=400
2025-03-06 15:07:21 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/register | RequestID=eea1c1e2-96e4-4f9a-a87f-fd361ad91dac | Время=2025-03-06T12:07:21.970525Z | Операция=REGISTER_USER
2025-03-06 15:07:21 | INFO  | r.k.serviceImpl.UserServiceImpl | Регистрация нового пользователя
2025-03-06 15:07:22 | WARN  | r.k.serviceImpl.UserServiceImpl | Попытка регистрации с уже существующим логином
2025-03-06 15:07:22 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/register | RequestID=eea1c1e2-96e4-4f9a-a87f-fd361ad91dac | Время=2025-03-06T12:07:21.970525Z | Длительность=43мс | Операция=REGISTER_USER | Статус=400
2025-03-06 15:07:45 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/register | RequestID=22e9fd0b-e48b-4b1a-8aa0-8aa37ea8ff3e | Время=2025-03-06T12:07:45.199896Z | Операция=REGISTER_USER
2025-03-06 15:07:45 | INFO  | r.k.serviceImpl.UserServiceImpl | Регистрация нового пользователя
2025-03-06 15:07:45 | INFO  | r.k.serviceImpl.UserServiceImpl | Пользователь зарегистрирован
2025-03-06 15:07:45 | INFO  | r.k.controllers.AuthController | Новый пользователь зарегистрирован
2025-03-06 15:07:45 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/register | RequestID=22e9fd0b-e48b-4b1a-8aa0-8aa37ea8ff3e | Время=2025-03-06T12:07:45.199896Z | Длительность=788мс | Операция=REGISTER_USER | Статус=201
2025-03-06 15:08:04 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/create | RequestID=0f9eaa38-8711-447f-b6cc-4b8c18d29eba | Время=2025-03-06T12:08:04.592199Z | Операция=CREATE_WALLET
2025-03-06 15:08:04 | WARN  | o.s.w.s.m.s.DefaultHandlerExceptionResolver | Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<ru.kalimulin.dto.walletDTO.WalletResponseDTO> ru.kalimulin.controllers.WalletController.createWallet(jakarta.servlet.http.HttpSession,ru.kalimulin.dto.walletDTO.WalletCreateDTO): [Field error in object 'walletCreateDTO' on field 'pin': rejected value [null]; codes [NotBlank.walletCreateDTO.pin,NotBlank.pin,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [walletCreateDTO.pin,pin]; arguments []; default message [pin]]; default message [Поле с PIN не может быть пустым]] ]
2025-03-06 15:08:04 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/create | RequestID=0f9eaa38-8711-447f-b6cc-4b8c18d29eba | Время=2025-03-06T12:08:04.592199Z | Длительность=51мс | Операция=CREATE_WALLET | Статус=400
2025-03-06 15:08:25 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/create | RequestID=c1ae6641-482e-425b-bc93-c02059323b8c | Время=2025-03-06T12:08:25.534688Z | Операция=CREATE_WALLET
2025-03-06 15:08:25 | INFO  | r.k.controllers.WalletController | Запрос на создание нового кошелька
2025-03-06 15:08:25 | INFO  | r.k.serviceImpl.WalletServiceImpl | Создание нового кошелька для пользователя
2025-03-06 15:08:25 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/create | RequestID=c1ae6641-482e-425b-bc93-c02059323b8c | Время=2025-03-06T12:08:25.534688Z | Длительность=39мс | Операция=CREATE_WALLET | Статус=400
2025-03-06 15:08:35 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/login | RequestID=c8f8e652-c260-4f8e-8807-0ff9521429fe | Время=2025-03-06T12:08:35.787496Z | Операция=LOGIN_USER
2025-03-06 15:08:35 | INFO  | r.k.serviceImpl.UserServiceImpl | Попытка входа пользователя:
2025-03-06 15:08:35 | INFO  | r.k.serviceImpl.UserServiceImpl | Успешный вход
2025-03-06 15:08:35 | INFO  | r.k.controllers.AuthController | Пользователь вошел в систему
2025-03-06 15:08:35 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/login | RequestID=c8f8e652-c260-4f8e-8807-0ff9521429fe | Время=2025-03-06T12:08:35.787496Z | Длительность=130мс | Операция=LOGIN_USER | Статус=200
2025-03-06 15:08:42 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/create | RequestID=cfadeb0e-74a5-4b79-93d2-02c2555738d8 | Время=2025-03-06T12:08:42.386036Z | Операция=CREATE_WALLET
2025-03-06 15:08:42 | WARN  | o.s.w.s.m.s.DefaultHandlerExceptionResolver | Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [1] in public org.springframework.http.ResponseEntity<ru.kalimulin.dto.walletDTO.WalletResponseDTO> ru.kalimulin.controllers.WalletController.createWallet(jakarta.servlet.http.HttpSession,ru.kalimulin.dto.walletDTO.WalletCreateDTO): [Field error in object 'walletCreateDTO' on field 'pin': rejected value [null]; codes [NotBlank.walletCreateDTO.pin,NotBlank.pin,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [walletCreateDTO.pin,pin]; arguments []; default message [pin]]; default message [Поле с PIN не может быть пустым]] ]
2025-03-06 15:08:42 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/create | RequestID=cfadeb0e-74a5-4b79-93d2-02c2555738d8 | Время=2025-03-06T12:08:42.386036Z | Длительность=3мс | Операция=CREATE_WALLET | Статус=400
2025-03-06 15:08:48 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/create | RequestID=2b4fb0e6-30f5-4c4f-ab63-abf3fbe5d523 | Время=2025-03-06T12:08:48.241711Z | Операция=CREATE_WALLET
2025-03-06 15:08:48 | WARN  | o.s.w.s.m.s.DefaultHandlerExceptionResolver | Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Unexpected character ('}' (code 125)): was expecting double-quote to start field name]
2025-03-06 15:08:48 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/create | RequestID=2b4fb0e6-30f5-4c4f-ab63-abf3fbe5d523 | Время=2025-03-06T12:08:48.241711Z | Длительность=2мс | Операция=CREATE_WALLET | Статус=400
2025-03-06 15:08:54 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/create | RequestID=d25debf0-845a-4ac4-915c-3b18735a21d6 | Время=2025-03-06T12:08:54.926354Z | Операция=CREATE_WALLET
2025-03-06 15:08:54 | INFO  | r.k.controllers.WalletController | Запрос на создание нового кошелька
2025-03-06 15:08:54 | INFO  | r.k.serviceImpl.WalletServiceImpl | Создание нового кошелька для пользователя
2025-03-06 15:08:55 | INFO  | r.k.serviceImpl.WalletServiceImpl | Кошелек создан
2025-03-06 15:08:55 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/create | RequestID=d25debf0-845a-4ac4-915c-3b18735a21d6 | Время=2025-03-06T12:08:54.926354Z | Длительность=381мс | Операция=CREATE_WALLET | Статус=201
2025-03-06 15:09:25 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/deposit | RequestID=37cb407e-bebf-41c6-828c-f33840113796 | Время=2025-03-06T12:09:25.892035Z | Операция=DEPOSIT_BALANCE
2025-03-06 15:09:25 | INFO  | r.k.controllers.WalletController | Запрос на пополнение баланса
2025-03-06 15:09:25 | INFO  | r.k.serviceImpl.WalletServiceImpl | Пополнение кошелька пользователя
2025-03-06 15:09:25 | INFO  | r.k.stubService.PaymentServiceImpl | Обработка платежа для пользователя test12 на сумму 1000
2025-03-06 15:09:25 | ERROR | r.k.stubService.PaymentServiceImpl | Ошибка обработки платежа для пользователя test12
2025-03-06 15:09:25 | ERROR | r.k.serviceImpl.WalletServiceImpl | Ошибка обработки платежа для пользователя
2025-03-06 15:09:25 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/deposit | RequestID=37cb407e-bebf-41c6-828c-f33840113796 | Время=2025-03-06T12:09:25.892035Z | Длительность=50мс | Операция=DEPOSIT_BALANCE | Статус=500
2025-03-06 15:09:27 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/deposit | RequestID=ba1298aa-c5ad-4ced-a7fc-1779abca001a | Время=2025-03-06T12:09:27.599747Z | Операция=DEPOSIT_BALANCE
2025-03-06 15:09:27 | INFO  | r.k.controllers.WalletController | Запрос на пополнение баланса
2025-03-06 15:09:27 | INFO  | r.k.serviceImpl.WalletServiceImpl | Пополнение кошелька пользователя
2025-03-06 15:09:27 | INFO  | r.k.stubService.PaymentServiceImpl | Обработка платежа для пользователя test12 на сумму 1000
2025-03-06 15:09:27 | ERROR | r.k.stubService.PaymentServiceImpl | Ошибка обработки платежа для пользователя test12
2025-03-06 15:09:27 | ERROR | r.k.serviceImpl.WalletServiceImpl | Ошибка обработки платежа для пользователя
2025-03-06 15:09:27 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/deposit | RequestID=ba1298aa-c5ad-4ced-a7fc-1779abca001a | Время=2025-03-06T12:09:27.599747Z | Длительность=19мс | Операция=DEPOSIT_BALANCE | Статус=500
2025-03-06 15:09:28 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/deposit | RequestID=2797e42a-a5b1-4368-be54-af6b04615fd6 | Время=2025-03-06T12:09:28.322286Z | Операция=DEPOSIT_BALANCE
2025-03-06 15:09:28 | INFO  | r.k.controllers.WalletController | Запрос на пополнение баланса
2025-03-06 15:09:28 | INFO  | r.k.serviceImpl.WalletServiceImpl | Пополнение кошелька пользователя
2025-03-06 15:09:28 | INFO  | r.k.stubService.PaymentServiceImpl | Обработка платежа для пользователя test12 на сумму 1000
2025-03-06 15:09:28 | INFO  | r.k.stubService.PaymentServiceImpl | Платеж для test12 на сумму 1000 успешно обработан
2025-03-06 15:09:28 | INFO  | r.k.serviceImpl.WalletServiceImpl | Баланс пользователя успешно пополнен
2025-03-06 15:09:28 | INFO  | r.k.controllers.WalletController | Баланс успешно пополнен!
2025-03-06 15:09:28 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/deposit | RequestID=2797e42a-a5b1-4368-be54-af6b04615fd6 | Время=2025-03-06T12:09:28.322286Z | Длительность=331мс | Операция=DEPOSIT_BALANCE | Статус=200
2025-03-06 15:10:04 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/cart | RequestID=745a643d-6f5b-4c4f-bdbb-3f75eecaad70 | Время=2025-03-06T12:10:04.826332Z | Операция=ADD_ITEM_TO_CART
2025-03-06 15:10:04 | INFO  | r.k.controllers.CartController | Запрос на добавление товара в корзину
2025-03-06 15:10:04 | INFO  | r.k.serviceImpl.CartServiceImpl | Запрос на добавление товара в корзину
2025-03-06 15:10:05 | INFO  | r.k.serviceImpl.CartServiceImpl | Товар добавлен в корзину
2025-03-06 15:10:05 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/cart | RequestID=745a643d-6f5b-4c4f-bdbb-3f75eecaad70 | Время=2025-03-06T12:10:04.826332Z | Длительность=698мс | Операция=ADD_ITEM_TO_CART | Статус=200
2025-03-06 15:10:19 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/order/create | RequestID=57df828f-2535-4bb4-bba4-70318ab098d8 | Время=2025-03-06T12:10:19.657616Z | Операция=UNKNOWN_OPERATION
2025-03-06 15:10:19 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/order/create | RequestID=57df828f-2535-4bb4-bba4-70318ab098d8 | Время=2025-03-06T12:10:19.657616Z | Длительность=13мс | Операция=UNKNOWN_OPERATION | Статус=404
2025-03-06 15:10:23 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/create | RequestID=2703fe90-827d-491b-a5aa-dd33b6ffae4e | Время=2025-03-06T12:10:23.740396Z | Операция=ORDER_CREATE
2025-03-06 15:10:23 | INFO  | r.k.controllers.OrderController | Запрос на создание заказа
2025-03-06 15:10:23 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка создать заказ
2025-03-06 15:10:24 | INFO  | r.k.serviceImpl.OrderServiceImpl | Заказ успешно создан
2025-03-06 15:10:24 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/create | RequestID=2703fe90-827d-491b-a5aa-dd33b6ffae4e | Время=2025-03-06T12:10:23.740396Z | Длительность=611мс | Операция=ORDER_CREATE | Статус=200
2025-03-06 15:10:34 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/payment/17 | RequestID=b42487c6-e60e-4d33-87e6-88c937c4b849 | Время=2025-03-06T12:10:34.071067Z | Операция=PAYMENT_ORDER
2025-03-06 15:10:34 | INFO  | r.k.controllers.OrderController | Запрос на оплату заказа
2025-03-06 15:10:34 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка оплатить заказ
2025-03-06 15:10:34 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/payment/17 | RequestID=b42487c6-e60e-4d33-87e6-88c937c4b849 | Время=2025-03-06T12:10:34.071067Z | Длительность=48мс | Операция=PAYMENT_ORDER | Статус=400
2025-03-06 15:12:21 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/address/create | RequestID=04a095d2-cf94-4baa-a3ba-732b51640c15 | Время=2025-03-06T12:12:21.066826Z | Операция=ADDRESS_CREATE
2025-03-06 15:12:21 | INFO  | r.k.controllers.AddressController | Запрос на создание нового адреса: AddressCreateDTO(country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Большая садовая 123, zipCode=344000)
2025-03-06 15:12:21 | INFO  | r.k.serviceImpl.AddressServiceImpl | Запрос на создание адреса от пользователя
2025-03-06 15:12:21 | INFO  | r.k.serviceImpl.AddressServiceImpl | Адрес успешно создан
2025-03-06 15:12:21 | INFO  | r.k.controllers.AddressController | Адрес успешно создан: AddressResponseDTO(country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Большая садовая 123, zipCode=344000)
2025-03-06 15:12:21 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/address/create | RequestID=04a095d2-cf94-4baa-a3ba-732b51640c15 | Время=2025-03-06T12:12:21.066826Z | Длительность=225мс | Операция=ADDRESS_CREATE | Статус=200
2025-03-06 15:12:37 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/address/create | RequestID=6ead1b69-3561-4dde-a942-bf922106b8ea | Время=2025-03-06T12:12:37.633577Z | Операция=ADDRESS_CREATE
2025-03-06 15:12:37 | INFO  | r.k.controllers.AddressController | Запрос на создание нового адреса: AddressCreateDTO(country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000)
2025-03-06 15:12:37 | INFO  | r.k.serviceImpl.AddressServiceImpl | Запрос на создание адреса от пользователя
2025-03-06 15:12:37 | INFO  | r.k.serviceImpl.AddressServiceImpl | Адрес успешно создан
2025-03-06 15:12:37 | INFO  | r.k.controllers.AddressController | Адрес успешно создан: AddressResponseDTO(country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000)
2025-03-06 15:12:37 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/address/create | RequestID=6ead1b69-3561-4dde-a942-bf922106b8ea | Время=2025-03-06T12:12:37.633577Z | Длительность=47мс | Операция=ADDRESS_CREATE | Статус=200
2025-03-06 15:12:50 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/payment | RequestID=79a3411b-ff23-4064-8200-7099b08aeb39 | Время=2025-03-06T12:12:50.034592Z | Операция=UNKNOWN_OPERATION
2025-03-06 15:12:50 | WARN  | o.s.w.s.m.s.DefaultHandlerExceptionResolver | Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'POST' is not supported]
2025-03-06 15:12:50 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/payment | RequestID=79a3411b-ff23-4064-8200-7099b08aeb39 | Время=2025-03-06T12:12:50.034592Z | Длительность=29мс | Операция=UNKNOWN_OPERATION | Статус=405
2025-03-06 15:12:59 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/payment/17 | RequestID=d2d34af5-6d06-4b57-a7e8-6ddb2b0b622f | Время=2025-03-06T12:12:59.659844Z | Операция=PAYMENT_ORDER
2025-03-06 15:12:59 | INFO  | r.k.controllers.OrderController | Запрос на оплату заказа
2025-03-06 15:12:59 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка оплатить заказ
2025-03-06 15:12:59 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/payment/17 | RequestID=d2d34af5-6d06-4b57-a7e8-6ddb2b0b622f | Время=2025-03-06T12:12:59.659844Z | Длительность=31мс | Операция=PAYMENT_ORDER | Статус=400
2025-03-06 15:13:38 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/payment/17?addressId=3 | RequestID=bf169a3c-dd67-4ddd-bee1-de40966a1d6e | Время=2025-03-06T12:13:38.178850Z | Операция=PAYMENT_ORDER
2025-03-06 15:13:38 | INFO  | r.k.controllers.OrderController | Запрос на оплату заказа
2025-03-06 15:13:38 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка оплатить заказ
2025-03-06 15:13:38 | INFO  | r.k.k.KafkaOrderEventPublisherImpl | Отправка email-уведомления в Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:38 | INFO  | o.a.k.c.producer.ProducerConfig | ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = SberSchoolShop-producer-1
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-03-06 15:13:38 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 15:13:38 | INFO  | o.a.k.clients.producer.KafkaProducer | [Producer clientId=SberSchoolShop-producer-1] Instantiated an idempotent producer.
2025-03-06 15:13:38 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 15:13:38 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 15:13:38 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741263218415
2025-03-06 15:13:38 | INFO  | org.apache.kafka.clients.Metadata | [Producer clientId=SberSchoolShop-producer-1] Cluster ID: rzT2QuncR2u6PaURJqk5_g
2025-03-06 15:13:38 | INFO  | r.k.serviceImpl.CartServiceImpl | Запрос на очищение корзины
2025-03-06 15:13:38 | INFO  | o.a.k.c.p.i.TransactionManager | [Producer clientId=SberSchoolShop-producer-1] ProducerId set to 4 with epoch 0
2025-03-06 15:13:38 | INFO  | r.k.serviceImpl.CartServiceImpl | Корзина очищена
2025-03-06 15:13:38 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:38 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/payment/17?addressId=3 | RequestID=bf169a3c-dd67-4ddd-bee1-de40966a1d6e | Время=2025-03-06T12:13:38.178850Z | Длительность=764мс | Операция=PAYMENT_ORDER | Статус=200
2025-03-06 15:13:40 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 4 for partition email-notifications-0
2025-03-06 15:13:40 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 15:13:40 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:41 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 4 for partition email-notifications-0
2025-03-06 15:13:41 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 15:13:41 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:43 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 4 for partition email-notifications-0
2025-03-06 15:13:43 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 15:13:43 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:45 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 4 for partition email-notifications-0
2025-03-06 15:13:45 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 15:13:45 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:46 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 4 for partition email-notifications-0
2025-03-06 15:13:46 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 15:13:46 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:48 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 4 for partition email-notifications-0
2025-03-06 15:13:48 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 15:13:48 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:49 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 4 for partition email-notifications-0
2025-03-06 15:13:49 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 15:13:49 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:51 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 4 for partition email-notifications-0
2025-03-06 15:13:51 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 15:13:51 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:52 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 4 for partition email-notifications-0
2025-03-06 15:13:52 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 15:13:52 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:13:54 | ERROR | o.s.k.listener.DefaultErrorHandler | Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for email-notifications-0@4
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void ru.kalimulin.kafka.consumers.EmailEventListener.listen(ru.kalimulin.dto.kafkaEventDTO.EmailNotificationEvent)' threw exception
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2989)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2896)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2860)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2772)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2609)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2498)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2149)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1525)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1463)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1332)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:840)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:489)
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:421)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2882)
Caused by: org.springframework.mail.MailSendException: Mail server connection failed. Failed messages: jakarta.mail.MessagingException: Exception reading response;
  nested exception is:
	java.net.SocketException: Connection reset
	at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:410)
	at org.springframework.mail.javamail.JavaMailSenderImpl.send(JavaMailSenderImpl.java:317)
	at org.springframework.mail.MailSender.send(MailSender.java:42)
	at ru.kalimulin.mail.EmailSenderImpl.sendEmail(EmailSenderImpl.java:33)
	at ru.kalimulin.mail.EmailSenderImpl.sendOrderNotification(EmailSenderImpl.java:24)
	at ru.kalimulin.kafka.consumers.EmailEventListener.listen(EmailEventListener.java:21)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:71)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:474)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:421)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2882)
	... 10 common frames omitted
Caused by: jakarta.mail.MessagingException: Exception reading response
	at org.eclipse.angus.mail.smtp.SMTPTransport.readServerResponse(SMTPTransport.java:2509)
	at org.eclipse.angus.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:2205)
	at org.eclipse.angus.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:729)
	at jakarta.mail.Service.connect(Service.java:345)
	at org.springframework.mail.javamail.JavaMailSenderImpl.connectTransport(JavaMailSenderImpl.java:480)
	at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:399)
	... 28 common frames omitted
Caused by: java.net.SocketException: Connection reset
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:328)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at org.eclipse.angus.mail.util.TraceInputStream.read(TraceInputStream.java:107)
	at java.base/java.io.BufferedInputStream.fill(BufferedInputStream.java:244)
	at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:263)
	at org.eclipse.angus.mail.util.LineInputStream.readLine(LineInputStream.java:104)
	at org.eclipse.angus.mail.smtp.SMTPTransport.readServerResponse(SMTPTransport.java:2489)
	... 33 common frames omitted
2025-03-06 15:14:22 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node -1 disconnected.
2025-03-06 15:14:33 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/cart | RequestID=5d197afd-8bb8-4ad7-8e37-5aa98426a50b | Время=2025-03-06T12:14:33.092592Z | Операция=ADD_ITEM_TO_CART
2025-03-06 15:14:33 | INFO  | r.k.controllers.CartController | Запрос на добавление товара в корзину
2025-03-06 15:14:33 | INFO  | r.k.serviceImpl.CartServiceImpl | Запрос на добавление товара в корзину
2025-03-06 15:14:34 | INFO  | r.k.serviceImpl.CartServiceImpl | Товар добавлен в корзину
2025-03-06 15:14:34 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/cart | RequestID=5d197afd-8bb8-4ad7-8e37-5aa98426a50b | Время=2025-03-06T12:14:33.092592Z | Длительность=1300мс | Операция=ADD_ITEM_TO_CART | Статус=200
2025-03-06 15:14:47 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/create | RequestID=b108a181-37c3-4ffd-aaff-6bdcc81e8d6f | Время=2025-03-06T12:14:47.962274Z | Операция=ORDER_CREATE
2025-03-06 15:14:47 | INFO  | r.k.controllers.OrderController | Запрос на создание заказа
2025-03-06 15:14:47 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка создать заказ
2025-03-06 15:14:48 | INFO  | r.k.serviceImpl.OrderServiceImpl | Заказ успешно создан
2025-03-06 15:14:48 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/create | RequestID=b108a181-37c3-4ffd-aaff-6bdcc81e8d6f | Время=2025-03-06T12:14:47.962274Z | Длительность=336мс | Операция=ORDER_CREATE | Статус=200
2025-03-06 15:14:57 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/payment | RequestID=0bf924c4-69f4-442b-b314-2554898683d1 | Время=2025-03-06T12:14:57.296749Z | Операция=UNKNOWN_OPERATION
2025-03-06 15:14:57 | WARN  | o.s.w.s.m.s.DefaultHandlerExceptionResolver | Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'POST' is not supported]
2025-03-06 15:14:57 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/payment | RequestID=0bf924c4-69f4-442b-b314-2554898683d1 | Время=2025-03-06T12:14:57.296749Z | Длительность=4мс | Операция=UNKNOWN_OPERATION | Статус=405
2025-03-06 15:15:02 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/payment/18 | RequestID=8d3e7a58-f5b9-463c-83e1-d2a170aa887a | Время=2025-03-06T12:15:02.102935Z | Операция=PAYMENT_ORDER
2025-03-06 15:15:02 | INFO  | r.k.controllers.OrderController | Запрос на оплату заказа
2025-03-06 15:15:02 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка оплатить заказ
2025-03-06 15:15:02 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/payment/18 | RequestID=8d3e7a58-f5b9-463c-83e1-d2a170aa887a | Время=2025-03-06T12:15:02.102935Z | Длительность=19мс | Операция=PAYMENT_ORDER | Статус=400
2025-03-06 15:15:11 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/payment/18?addressId=3 | RequestID=b1bbd74a-0b6e-40cb-bc5c-b389e0ee69a6 | Время=2025-03-06T12:15:11.249614Z | Операция=PAYMENT_ORDER
2025-03-06 15:15:11 | INFO  | r.k.controllers.OrderController | Запрос на оплату заказа
2025-03-06 15:15:11 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка оплатить заказ
2025-03-06 15:15:11 | INFO  | r.k.k.KafkaOrderEventPublisherImpl | Отправка email-уведомления в Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:15:11 | INFO  | r.k.serviceImpl.CartServiceImpl | Запрос на очищение корзины
2025-03-06 15:15:11 | INFO  | r.k.serviceImpl.CartServiceImpl | Корзина очищена
2025-03-06 15:15:11 | INFO  | r.kalimulin.kafka.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=3, country=Россия, region=Ростовская область, city=Ростов-на-Дону, street=Стачки 90, zipCode=344000))
2025-03-06 15:15:11 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/payment/18?addressId=3 | RequestID=b1bbd74a-0b6e-40cb-bc5c-b389e0ee69a6 | Время=2025-03-06T12:15:11.249614Z | Длительность=459мс | Операция=PAYMENT_ORDER | Статус=200
2025-03-06 15:15:14 | INFO  | r.kalimulin.kafka.EmailEventListener | Email-уведомление отправлено продавцу: qwe.asd345921@yandex.ru
2025-03-06 15:16:00 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Revoke previously assigned partitions email-notifications-0
2025-03-06 15:16:00 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions revoked: [email-notifications-0]
2025-03-06 15:16:00 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Member consumer-email-group-1-eebb9a3a-338e-425f-82c8-ea8b0e66e418 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-03-06 15:16:00 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 15:16:00 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 15:16:00 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Unsubscribed all topics or patterns and assigned partitions
2025-03-06 15:16:00 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 15:16:00 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 15:16:00 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 15:16:00 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 15:16:00 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 15:16:00 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 15:16:00 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.consumer for consumer-email-group-1 unregistered
2025-03-06 15:16:00 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: Consumer stopped
2025-03-06 15:16:00 | INFO  | o.s.b.w.e.tomcat.GracefulShutdown | Commencing graceful shutdown. Waiting for active requests to complete
2025-03-06 15:16:00 | INFO  | o.s.b.w.e.tomcat.GracefulShutdown | Graceful shutdown complete
2025-03-06 15:16:00 | INFO  | o.a.k.clients.producer.KafkaProducer | [Producer clientId=SberSchoolShop-producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-03-06 15:16:00 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 15:16:00 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 15:16:00 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 15:16:00 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 15:16:00 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.producer for SberSchoolShop-producer-1 unregistered
2025-03-06 15:16:00 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 15:16:00 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown initiated...
2025-03-06 15:16:00 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown completed.
2025-03-06 16:36:33 | INFO  | o.h.validator.internal.util.Version | HV000001: Hibernate Validator 8.0.2.Final
2025-03-06 16:36:33 | INFO  | ru.kalimulin.SberSchoolShop | Starting SberSchoolShop using Java 17.0.11 with PID 74493 (/Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop/web/target/classes started by deniskalimulin in /Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop)
2025-03-06 16:36:33 | INFO  | ru.kalimulin.SberSchoolShop | No active profile set, falling back to 1 default profile: "default"
2025-03-06 16:36:33 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-06 16:36:33 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Finished Spring Data repository scanning in 53 ms. Found 13 JPA repository interfaces.
2025-03-06 16:36:34 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat initialized with port 8080 (http)
2025-03-06 16:36:34 | INFO  | o.a.coyote.http11.Http11NioProtocol | Initializing ProtocolHandler ["http-nio-8080"]
2025-03-06 16:36:34 | INFO  | o.a.catalina.core.StandardService | Starting service [Tomcat]
2025-03-06 16:36:34 | INFO  | o.a.catalina.core.StandardEngine | Starting Servlet engine: [Apache Tomcat/10.1.34]
2025-03-06 16:36:34 | INFO  | o.a.c.c.C.[Tomcat].[localhost].[/] | Initializing Spring embedded WebApplicationContext
2025-03-06 16:36:34 | INFO  | o.s.b.w.s.c.ServletWebServerApplicationContext | Root WebApplicationContext: initialization completed in 1281 ms
2025-03-06 16:36:34 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Starting...
2025-03-06 16:36:36 | INFO  | com.zaxxer.hikari.pool.HikariPool | HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@ee2ae9a
2025-03-06 16:36:36 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Start completed.
2025-03-06 16:36:36 | INFO  | o.h.jpa.internal.util.LogHelper | HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-06 16:36:36 | INFO  | org.hibernate.Version | HHH000412: Hibernate ORM core version 6.6.5.Final
2025-03-06 16:36:36 | INFO  | o.h.c.i.RegionFactoryInitiator | HHH000026: Second-level cache disabled
2025-03-06 16:36:36 | INFO  | o.s.o.j.p.SpringPersistenceUnitInfo | No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-06 16:36:37 | WARN  | org.hibernate.orm.deprecation | HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-06 16:36:37 | INFO  | o.hibernate.orm.connections.pooling | HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.3
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-06 16:36:38 | INFO  | o.h.e.t.j.p.i.JtaPlatformInitiator | HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-06 16:36:38 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 16:36:38 | INFO  | o.s.d.j.r.query.QueryEnhancerFactory | Hibernate is in classpath; If applicable, HQL parser will be used.
2025-03-06 16:36:39 | WARN  | o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext | Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'orderController' defined in file [/Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop/web/target/classes/ru/kalimulin/controllers/OrderController.class]: Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'orderServiceImpl' defined in file [/Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop/service/target/classes/ru/kalimulin/serviceImpl/OrderServiceImpl.class]: Unsatisfied dependency expressed through constructor parameter 9: Error creating bean with name 'inventoryEventProducerImpl' defined in file [/Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop/web/target/classes/ru/kalimulin/kafka/producers/InventoryEventProducerImpl.class]: Unsatisfied dependency expressed through constructor parameter 0: No qualifying bean of type 'org.springframework.kafka.core.KafkaTemplate<java.lang.String, ru.kalimulin.dto.kafkaEventDTO.InventoryUpdateEvent>' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
2025-03-06 16:36:39 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 16:36:39 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown initiated...
2025-03-06 16:36:39 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown completed.
2025-03-06 16:36:39 | INFO  | o.a.catalina.core.StandardService | Stopping service [Tomcat]
2025-03-06 16:36:39 | INFO  | o.s.b.a.l.ConditionEvaluationReportLogger | 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-03-06 16:36:39 | ERROR | o.s.b.d.LoggingFailureAnalysisReporter | 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 0 of constructor in ru.kalimulin.kafka.producers.InventoryEventProducerImpl required a bean of type 'org.springframework.kafka.core.KafkaTemplate' that could not be found.


Action:

Consider defining a bean of type 'org.springframework.kafka.core.KafkaTemplate' in your configuration.

2025-03-06 16:38:58 | INFO  | o.h.validator.internal.util.Version | HV000001: Hibernate Validator 8.0.2.Final
2025-03-06 16:38:58 | INFO  | ru.kalimulin.SberSchoolShop | Starting SberSchoolShop using Java 17.0.11 with PID 74644 (/Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop/web/target/classes started by deniskalimulin in /Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop)
2025-03-06 16:38:58 | INFO  | ru.kalimulin.SberSchoolShop | No active profile set, falling back to 1 default profile: "default"
2025-03-06 16:38:59 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-06 16:38:59 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Finished Spring Data repository scanning in 58 ms. Found 13 JPA repository interfaces.
2025-03-06 16:39:00 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat initialized with port 8080 (http)
2025-03-06 16:39:00 | INFO  | o.a.coyote.http11.Http11NioProtocol | Initializing ProtocolHandler ["http-nio-8080"]
2025-03-06 16:39:00 | INFO  | o.a.catalina.core.StandardService | Starting service [Tomcat]
2025-03-06 16:39:00 | INFO  | o.a.catalina.core.StandardEngine | Starting Servlet engine: [Apache Tomcat/10.1.34]
2025-03-06 16:39:00 | INFO  | o.a.c.c.C.[Tomcat].[localhost].[/] | Initializing Spring embedded WebApplicationContext
2025-03-06 16:39:00 | INFO  | o.s.b.w.s.c.ServletWebServerApplicationContext | Root WebApplicationContext: initialization completed in 1279 ms
2025-03-06 16:39:00 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Starting...
2025-03-06 16:39:01 | INFO  | com.zaxxer.hikari.pool.HikariPool | HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@7910f355
2025-03-06 16:39:01 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Start completed.
2025-03-06 16:39:01 | INFO  | o.h.jpa.internal.util.LogHelper | HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-06 16:39:01 | INFO  | org.hibernate.Version | HHH000412: Hibernate ORM core version 6.6.5.Final
2025-03-06 16:39:01 | INFO  | o.h.c.i.RegionFactoryInitiator | HHH000026: Second-level cache disabled
2025-03-06 16:39:01 | INFO  | o.s.o.j.p.SpringPersistenceUnitInfo | No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-06 16:39:02 | WARN  | org.hibernate.orm.deprecation | HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-06 16:39:02 | INFO  | o.hibernate.orm.connections.pooling | HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.3
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-06 16:39:02 | INFO  | o.h.e.t.j.p.i.JtaPlatformInitiator | HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-06 16:39:02 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 16:39:03 | INFO  | o.s.d.j.r.query.QueryEnhancerFactory | Hibernate is in classpath; If applicable, HQL parser will be used.
2025-03-06 16:39:04 | INFO  | o.a.coyote.http11.Http11NioProtocol | Starting ProtocolHandler ["http-nio-8080"]
2025-03-06 16:39:04 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat started on port 8080 (http) with context path '/'
2025-03-06 16:39:04 | INFO  | o.a.k.c.consumer.ConsumerConfig | ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-03-06 16:39:04 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 16:39:04 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 16:39:04 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 16:39:04 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741268344409
2025-03-06 16:39:04 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Subscribed to topic(s): email-notifications
2025-03-06 16:39:04 | INFO  | o.a.k.c.consumer.ConsumerConfig | ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-inventory-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = inventory-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-03-06 16:39:04 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 16:39:04 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 16:39:04 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 16:39:04 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741268344420
2025-03-06 16:39:04 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Subscribed to topic(s): inventory-updates
2025-03-06 16:39:04 | INFO  | ru.kalimulin.SberSchoolShop | Started SberSchoolShop in 6.06 seconds (process running for 6.511)
2025-03-06 16:39:04 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cluster ID: rzT2QuncR2u6PaURJqk5_g
2025-03-06 16:39:04 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-03-06 16:39:04 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 16:39:04 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: need to re-join with the given member-id: consumer-email-group-1-d9ff0971-070a-4bf8-bb6e-367d6d231034
2025-03-06 16:39:04 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 16:39:05 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Error while fetching metadata with correlation id 2 : {inventory-updates=LEADER_NOT_AVAILABLE}
2025-03-06 16:39:05 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cluster ID: rzT2QuncR2u6PaURJqk5_g
2025-03-06 16:39:05 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-03-06 16:39:05 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] (Re-)joining group
2025-03-06 16:39:05 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: need to re-join with the given member-id: consumer-inventory-group-2-9dee0718-70f8-4b77-985a-bc8b26803876
2025-03-06 16:39:05 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] (Re-)joining group
2025-03-06 16:39:05 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Error while fetching metadata with correlation id 8 : {inventory-updates=LEADER_NOT_AVAILABLE}
2025-03-06 16:39:05 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Error while fetching metadata with correlation id 9 : {inventory-updates=LEADER_NOT_AVAILABLE}
2025-03-06 16:39:07 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully joined group with generation Generation{generationId=27, memberId='consumer-email-group-1-d9ff0971-070a-4bf8-bb6e-367d6d231034', protocol='range'}
2025-03-06 16:39:07 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Finished assignment for group at generation 27: {consumer-email-group-1-d9ff0971-070a-4bf8-bb6e-367d6d231034=Assignment(partitions=[email-notifications-0])}
2025-03-06 16:39:07 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully synced group in generation Generation{generationId=27, memberId='consumer-email-group-1-d9ff0971-070a-4bf8-bb6e-367d6d231034', protocol='range'}
2025-03-06 16:39:07 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Notifying assignor about the new Assignment(partitions=[email-notifications-0])
2025-03-06 16:39:07 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Adding newly assigned partitions: email-notifications-0
2025-03-06 16:39:07 | INFO  | o.a.k.c.c.internals.ConsumerUtils | Setting offset for partition email-notifications-0 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-03-06 16:39:07 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions assigned: [email-notifications-0]
2025-03-06 16:39:08 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Successfully joined group with generation Generation{generationId=1, memberId='consumer-inventory-group-2-9dee0718-70f8-4b77-985a-bc8b26803876', protocol='range'}
2025-03-06 16:39:08 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Finished assignment for group at generation 1: {consumer-inventory-group-2-9dee0718-70f8-4b77-985a-bc8b26803876=Assignment(partitions=[inventory-updates-0])}
2025-03-06 16:39:08 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Successfully synced group in generation Generation{generationId=1, memberId='consumer-inventory-group-2-9dee0718-70f8-4b77-985a-bc8b26803876', protocol='range'}
2025-03-06 16:39:08 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Notifying assignor about the new Assignment(partitions=[inventory-updates-0])
2025-03-06 16:39:08 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Adding newly assigned partitions: inventory-updates-0
2025-03-06 16:39:08 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Found no committed offset for partition inventory-updates-0
2025-03-06 16:39:08 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Found no committed offset for partition inventory-updates-0
2025-03-06 16:39:08 | INFO  | o.a.k.c.c.i.SubscriptionState | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Resetting offset for partition inventory-updates-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-03-06 16:39:08 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: partitions assigned: [inventory-updates-0]
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 2147483646 disconnected.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight FETCH request with correlation id 399 due to node 1 being disconnected (elapsed time since creation: 453ms, elapsed time since send: 453ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node -1 disconnected.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 2147483646 disconnected.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:41:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Group coordinator localhost:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable. isDisconnected: true. Rediscovery will be attempted.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight FETCH request with correlation id 395 due to node 1 being disconnected (elapsed time since creation: 471ms, elapsed time since send: 471ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight METADATA request with correlation id 396 due to node 1 being disconnected (elapsed time since creation: 399ms, elapsed time since send: 399ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node -1 disconnected.
2025-03-06 16:41:55 | INFO  | o.a.k.clients.FetchSessionHandler | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Error sending fetch request (sessionId=973036720, epoch=328) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
2025-03-06 16:41:55 | INFO  | o.a.k.clients.FetchSessionHandler | [Consumer clientId=consumer-email-group-1, groupId=email-group] Error sending fetch request (sessionId=633607092, epoch=329) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
2025-03-06 16:41:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Group coordinator localhost:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable. isDisconnected: true. Rediscovery will be attempted.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 397 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 400 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 398 due to node 1 being disconnected (elapsed time since creation: 3ms, elapsed time since send: 3ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 401 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 402 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:41:55 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 399 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:56 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:41:56 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 403 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:56 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:41:56 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 400 due to node 1 being disconnected (elapsed time since creation: 0ms, elapsed time since send: 0ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:41:57 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:41:57 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:41:57 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:41:57 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:41:58 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:41:58 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:41:58 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:41:58 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:41:59 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:41:59 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:41:59 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:41:59 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:00 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:00 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:00 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:00 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:01 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:01 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:01 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:01 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:02 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:02 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:02 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:02 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:03 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:03 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:03 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:03 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:04 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:04 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:04 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:04 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:05 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:05 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:05 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:05 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:06 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:06 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:06 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:06 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:07 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:07 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:07 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:07 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:08 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:08 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:08 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:08 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Connection to node 1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-03-06 16:42:09 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:09 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 404 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:09 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:09 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 401 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:10 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:10 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 405 due to node 1 being disconnected (elapsed time since creation: 3ms, elapsed time since send: 3ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:10 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:10 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 402 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:11 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:11 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 406 due to node 1 being disconnected (elapsed time since creation: 3ms, elapsed time since send: 3ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:11 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:11 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 403 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:12 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:12 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 407 due to node 1 being disconnected (elapsed time since creation: 28ms, elapsed time since send: 28ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:12 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:12 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 404 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:13 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:13 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 408 due to node 1 being disconnected (elapsed time since creation: 3ms, elapsed time since send: 3ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:13 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:13 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 405 due to node 1 being disconnected (elapsed time since creation: 8ms, elapsed time since send: 8ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:14 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:14 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 409 due to node 1 being disconnected (elapsed time since creation: 4ms, elapsed time since send: 4ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:14 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:14 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 406 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:15 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:15 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 410 due to node 1 being disconnected (elapsed time since creation: 1ms, elapsed time since send: 1ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:15 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node 1 disconnected.
2025-03-06 16:42:15 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cancelled in-flight API_VERSIONS request with correlation id 407 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:16 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 disconnected.
2025-03-06 16:42:16 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cancelled in-flight API_VERSIONS request with correlation id 411 due to node 1 being disconnected (elapsed time since creation: 2ms, elapsed time since send: 2ms, throttle time: 0ms, request timeout: 30000ms)
2025-03-06 16:42:16 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Error while fetching metadata with correlation id 409 : {email-notifications=LEADER_NOT_AVAILABLE}
2025-03-06 16:42:16 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cluster ID: 8qJM25-_Sz2H6XnzvywSlA
2025-03-06 16:42:16 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Error while fetching metadata with correlation id 411 : {email-notifications=LEADER_NOT_AVAILABLE}
2025-03-06 16:42:17 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting the last seen epoch of partition email-notifications-0 to 0 since the associated topicId changed from null to dLAAP0cmRSWFriA-LfqHPA
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Attempt to heartbeat with Generation{generationId=27, memberId='consumer-email-group-1-d9ff0971-070a-4bf8-bb6e-367d6d231034', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting generation and member id due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Giving away all assigned partitions as lost since generation/memberID has been reset,indicating that consumer is in old state or no longer part of the group
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Lost previously assigned partitions email-notifications-0
2025-03-06 16:42:17 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions lost: [email-notifications-0]
2025-03-06 16:42:17 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions revoked: [email-notifications-0]
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: need to re-join with the given member-id: consumer-email-group-1-3ed04e05-d3a9-41fa-bf90-d1096d8d37b6
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 16:42:17 | WARN  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Error while fetching metadata with correlation id 413 : {inventory-updates=LEADER_NOT_AVAILABLE}
2025-03-06 16:42:17 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cluster ID: 8qJM25-_Sz2H6XnzvywSlA
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: cached metadata has changed from (version5: {inventory-updates=[NO_RACKS]}) at the beginning of the rebalance to (version6: {inventory-updates=[]})
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Revoke previously assigned partitions inventory-updates-0
2025-03-06 16:42:17 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: partitions revoked: [inventory-updates-0]
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] (Re-)joining group
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Attempt to heartbeat with Generation{generationId=1, memberId='consumer-inventory-group-2-9dee0718-70f8-4b77-985a-bc8b26803876', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Resetting generation and member id due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] JoinGroup failed: The coordinator is not aware of this member. Need to re-join the group. Sent generation was Generation{generationId=1, memberId='consumer-inventory-group-2-9dee0718-70f8-4b77-985a-bc8b26803876', protocol='range'}
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: rebalance failed due to 'The coordinator is not aware of this member.' (UnknownMemberIdException)
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] (Re-)joining group
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: need to re-join with the given member-id: consumer-inventory-group-2-2c3ec064-0e51-4646-980b-3006b57c1c4c
2025-03-06 16:42:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] (Re-)joining group
2025-03-06 16:42:17 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Resetting the last seen epoch of partition inventory-updates-0 to 0 since the associated topicId changed from null to 0tg27pmRTf-CzPu5zziPsg
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully joined group with generation Generation{generationId=1, memberId='consumer-email-group-1-3ed04e05-d3a9-41fa-bf90-d1096d8d37b6', protocol='range'}
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Finished assignment for group at generation 1: {consumer-email-group-1-3ed04e05-d3a9-41fa-bf90-d1096d8d37b6=Assignment(partitions=[email-notifications-0])}
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully synced group in generation Generation{generationId=1, memberId='consumer-email-group-1-3ed04e05-d3a9-41fa-bf90-d1096d8d37b6', protocol='range'}
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Notifying assignor about the new Assignment(partitions=[email-notifications-0])
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Adding newly assigned partitions: email-notifications-0
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Found no committed offset for partition email-notifications-0
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Found no committed offset for partition email-notifications-0
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.SubscriptionState | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting offset for partition email-notifications-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-03-06 16:42:20 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions assigned: [email-notifications-0]
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Successfully joined group with generation Generation{generationId=1, memberId='consumer-inventory-group-2-2c3ec064-0e51-4646-980b-3006b57c1c4c', protocol='range'}
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Finished assignment for group at generation 1: {consumer-inventory-group-2-2c3ec064-0e51-4646-980b-3006b57c1c4c=Assignment(partitions=[inventory-updates-0])}
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Successfully synced group in generation Generation{generationId=1, memberId='consumer-inventory-group-2-2c3ec064-0e51-4646-980b-3006b57c1c4c', protocol='range'}
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Notifying assignor about the new Assignment(partitions=[inventory-updates-0])
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Adding newly assigned partitions: inventory-updates-0
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Found no committed offset for partition inventory-updates-0
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Found no committed offset for partition inventory-updates-0
2025-03-06 16:42:20 | INFO  | o.a.k.c.c.i.SubscriptionState | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Resetting offset for partition inventory-updates-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}.
2025-03-06 16:42:20 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: partitions assigned: [inventory-updates-0]
2025-03-06 16:42:20 | INFO  | o.a.k.clients.FetchSessionHandler | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node 1 was unable to process the fetch request with (sessionId=396752698, epoch=1): FETCH_SESSION_TOPIC_ID_ERROR.
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Revoke previously assigned partitions inventory-updates-0
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Revoke previously assigned partitions email-notifications-0
2025-03-06 16:49:06 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: partitions revoked: [inventory-updates-0]
2025-03-06 16:49:06 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions revoked: [email-notifications-0]
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Member consumer-inventory-group-2-2c3ec064-0e51-4646-980b-3006b57c1c4c sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Member consumer-email-group-1-3ed04e05-d3a9-41fa-bf90-d1096d8d37b6 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Unsubscribed all topics or patterns and assigned partitions
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Unsubscribed all topics or patterns and assigned partitions
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 16:49:06 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 16:49:06 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 16:49:06 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 16:49:06 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 16:49:06 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 16:49:06 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 16:49:06 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 16:49:06 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 16:49:06 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 16:49:06 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.consumer for consumer-email-group-1 unregistered
2025-03-06 16:49:06 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.consumer for consumer-inventory-group-2 unregistered
2025-03-06 16:49:06 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: Consumer stopped
2025-03-06 16:49:06 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: Consumer stopped
2025-03-06 16:49:06 | INFO  | o.s.b.w.e.tomcat.GracefulShutdown | Commencing graceful shutdown. Waiting for active requests to complete
2025-03-06 16:49:06 | INFO  | o.s.b.w.e.tomcat.GracefulShutdown | Graceful shutdown complete
2025-03-06 16:49:06 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 16:49:06 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown initiated...
2025-03-06 16:49:06 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown completed.
2025-03-06 16:49:08 | INFO  | o.h.validator.internal.util.Version | HV000001: Hibernate Validator 8.0.2.Final
2025-03-06 16:49:09 | INFO  | ru.kalimulin.SberSchoolShop | Starting SberSchoolShop using Java 17.0.11 with PID 75152 (/Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop/web/target/classes started by deniskalimulin in /Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop)
2025-03-06 16:49:09 | INFO  | ru.kalimulin.SberSchoolShop | No active profile set, falling back to 1 default profile: "default"
2025-03-06 16:49:09 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-06 16:49:09 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Finished Spring Data repository scanning in 41 ms. Found 13 JPA repository interfaces.
2025-03-06 16:49:10 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat initialized with port 8080 (http)
2025-03-06 16:49:10 | INFO  | o.a.coyote.http11.Http11NioProtocol | Initializing ProtocolHandler ["http-nio-8080"]
2025-03-06 16:49:10 | INFO  | o.a.catalina.core.StandardService | Starting service [Tomcat]
2025-03-06 16:49:10 | INFO  | o.a.catalina.core.StandardEngine | Starting Servlet engine: [Apache Tomcat/10.1.34]
2025-03-06 16:49:10 | INFO  | o.a.c.c.C.[Tomcat].[localhost].[/] | Initializing Spring embedded WebApplicationContext
2025-03-06 16:49:10 | INFO  | o.s.b.w.s.c.ServletWebServerApplicationContext | Root WebApplicationContext: initialization completed in 1036 ms
2025-03-06 16:49:10 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Starting...
2025-03-06 16:49:11 | INFO  | com.zaxxer.hikari.pool.HikariPool | HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@7910f355
2025-03-06 16:49:11 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Start completed.
2025-03-06 16:49:11 | INFO  | o.h.jpa.internal.util.LogHelper | HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-06 16:49:11 | INFO  | org.hibernate.Version | HHH000412: Hibernate ORM core version 6.6.5.Final
2025-03-06 16:49:11 | INFO  | o.h.c.i.RegionFactoryInitiator | HHH000026: Second-level cache disabled
2025-03-06 16:49:11 | INFO  | o.s.o.j.p.SpringPersistenceUnitInfo | No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-06 16:49:12 | WARN  | org.hibernate.orm.deprecation | HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-06 16:49:12 | INFO  | o.hibernate.orm.connections.pooling | HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.3
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-06 16:49:12 | INFO  | o.h.e.t.j.p.i.JtaPlatformInitiator | HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-06 16:49:12 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 16:49:12 | INFO  | o.s.d.j.r.query.QueryEnhancerFactory | Hibernate is in classpath; If applicable, HQL parser will be used.
2025-03-06 16:49:13 | INFO  | o.a.coyote.http11.Http11NioProtocol | Starting ProtocolHandler ["http-nio-8080"]
2025-03-06 16:49:13 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat started on port 8080 (http) with context path '/'
2025-03-06 16:49:13 | INFO  | o.a.k.c.consumer.ConsumerConfig | ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-03-06 16:49:13 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 16:49:13 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 16:49:13 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 16:49:13 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741268953911
2025-03-06 16:49:13 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Subscribed to topic(s): email-notifications
2025-03-06 16:49:13 | INFO  | o.a.k.c.consumer.ConsumerConfig | ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-inventory-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = inventory-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-03-06 16:49:13 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 16:49:13 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 16:49:13 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 16:49:13 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741268953923
2025-03-06 16:49:13 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Subscribed to topic(s): inventory-updates
2025-03-06 16:49:13 | INFO  | ru.kalimulin.SberSchoolShop | Started SberSchoolShop in 5.292 seconds (process running for 5.791)
2025-03-06 16:49:14 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cluster ID: 8qJM25-_Sz2H6XnzvywSlA
2025-03-06 16:49:14 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cluster ID: 8qJM25-_Sz2H6XnzvywSlA
2025-03-06 16:49:14 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-03-06 16:49:14 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-03-06 16:49:14 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] (Re-)joining group
2025-03-06 16:49:14 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 16:49:14 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: need to re-join with the given member-id: consumer-email-group-1-541d2c21-00b8-415c-9ed6-4a71c013c794
2025-03-06 16:49:14 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 16:49:14 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: need to re-join with the given member-id: consumer-inventory-group-2-93739533-db5b-4225-ac95-b2309874209a
2025-03-06 16:49:14 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] (Re-)joining group
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully joined group with generation Generation{generationId=3, memberId='consumer-email-group-1-541d2c21-00b8-415c-9ed6-4a71c013c794', protocol='range'}
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Successfully joined group with generation Generation{generationId=3, memberId='consumer-inventory-group-2-93739533-db5b-4225-ac95-b2309874209a', protocol='range'}
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Finished assignment for group at generation 3: {consumer-inventory-group-2-93739533-db5b-4225-ac95-b2309874209a=Assignment(partitions=[inventory-updates-0])}
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Finished assignment for group at generation 3: {consumer-email-group-1-541d2c21-00b8-415c-9ed6-4a71c013c794=Assignment(partitions=[email-notifications-0])}
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully synced group in generation Generation{generationId=3, memberId='consumer-email-group-1-541d2c21-00b8-415c-9ed6-4a71c013c794', protocol='range'}
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Successfully synced group in generation Generation{generationId=3, memberId='consumer-inventory-group-2-93739533-db5b-4225-ac95-b2309874209a', protocol='range'}
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Notifying assignor about the new Assignment(partitions=[inventory-updates-0])
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Notifying assignor about the new Assignment(partitions=[email-notifications-0])
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Adding newly assigned partitions: email-notifications-0
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Adding newly assigned partitions: inventory-updates-0
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.internals.ConsumerUtils | Setting offset for partition email-notifications-0 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-03-06 16:49:17 | INFO  | o.a.k.c.c.internals.ConsumerUtils | Setting offset for partition inventory-updates-0 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-03-06 16:49:17 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions assigned: [email-notifications-0]
2025-03-06 16:49:17 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: partitions assigned: [inventory-updates-0]
2025-03-06 16:49:47 | INFO  | o.a.c.c.C.[Tomcat].[localhost].[/] | Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-03-06 16:49:47 | INFO  | o.s.web.servlet.DispatcherServlet | Initializing Servlet 'dispatcherServlet'
2025-03-06 16:49:47 | INFO  | o.s.web.servlet.DispatcherServlet | Completed initialization in 3 ms
2025-03-06 16:49:47 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/login | RequestID=fdab7931-bc4c-4e77-84f5-7ca2d0941884 | Время=2025-03-06T13:49:47.329121Z | Операция=LOGIN_USER
2025-03-06 16:49:47 | INFO  | r.k.serviceImpl.UserServiceImpl | Попытка входа пользователя:
2025-03-06 16:49:48 | INFO  | r.k.serviceImpl.UserServiceImpl | Успешный вход
2025-03-06 16:49:48 | INFO  | r.k.controllers.AuthController | Пользователь вошел в систему
2025-03-06 16:49:48 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/login | RequestID=fdab7931-bc4c-4e77-84f5-7ca2d0941884 | Время=2025-03-06T13:49:47.329121Z | Длительность=1092мс | Операция=LOGIN_USER | Статус=200
2025-03-06 16:50:20 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/cart | RequestID=8db10b8b-52e0-4415-91f2-f0c267135f35 | Время=2025-03-06T13:50:20.611559Z | Операция=ADD_ITEM_TO_CART
2025-03-06 16:50:20 | INFO  | r.k.controllers.CartController | Запрос на добавление товара в корзину
2025-03-06 16:50:20 | INFO  | r.k.serviceImpl.CartServiceImpl | Запрос на добавление товара в корзину
2025-03-06 16:50:21 | INFO  | r.k.serviceImpl.CartServiceImpl | Товар добавлен в корзину
2025-03-06 16:50:21 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/cart | RequestID=8db10b8b-52e0-4415-91f2-f0c267135f35 | Время=2025-03-06T13:50:20.611559Z | Длительность=944мс | Операция=ADD_ITEM_TO_CART | Статус=200
2025-03-06 16:50:37 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/create | RequestID=9fa3145b-41f9-4696-91a0-7e96dade5a55 | Время=2025-03-06T13:50:37.399336Z | Операция=ORDER_CREATE
2025-03-06 16:50:37 | INFO  | r.k.controllers.OrderController | Запрос на создание заказа
2025-03-06 16:50:37 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка создать заказ
2025-03-06 16:50:37 | INFO  | r.k.serviceImpl.OrderServiceImpl | Заказ успешно создан
2025-03-06 16:50:37 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/create | RequestID=9fa3145b-41f9-4696-91a0-7e96dade5a55 | Время=2025-03-06T13:50:37.399336Z | Длительность=590мс | Операция=ORDER_CREATE | Статус=200
2025-03-06 16:51:02 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/payment/19?addressId=1 | RequestID=0753699e-26dd-4ebb-a13b-a31875926f6e | Время=2025-03-06T13:51:02.669581Z | Операция=PAYMENT_ORDER
2025-03-06 16:51:02 | INFO  | r.k.controllers.OrderController | Запрос на оплату заказа
2025-03-06 16:51:02 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка оплатить заказ
2025-03-06 16:51:02 | INFO  | o.a.k.c.producer.ProducerConfig | ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = SberSchoolShop-producer-1
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-03-06 16:51:02 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 16:51:02 | INFO  | o.a.k.clients.producer.KafkaProducer | [Producer clientId=SberSchoolShop-producer-1] Instantiated an idempotent producer.
2025-03-06 16:51:02 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 16:51:02 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 16:51:02 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741269062848
2025-03-06 16:51:02 | INFO  | org.apache.kafka.clients.Metadata | [Producer clientId=SberSchoolShop-producer-1] Cluster ID: 8qJM25-_Sz2H6XnzvywSlA
2025-03-06 16:51:02 | INFO  | r.k.k.p.KafkaOrderEventPublisherImpl | Отправка email-уведомления в Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 16:51:02 | INFO  | o.a.k.c.producer.ProducerConfig | ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = SberSchoolShop-producer-1
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-03-06 16:51:02 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 16:51:02 | INFO  | o.a.k.clients.producer.KafkaProducer | [Producer clientId=SberSchoolShop-producer-1] Instantiated an idempotent producer.
2025-03-06 16:51:02 | INFO  | o.a.kafka.common.utils.AppInfoParser | The mbean of App info: [kafka.producer], id: [SberSchoolShop-producer-1] already exists, so skipping a new mbean creation.
2025-03-06 16:51:02 | INFO  | org.apache.kafka.clients.Metadata | [Producer clientId=SberSchoolShop-producer-1] Cluster ID: 8qJM25-_Sz2H6XnzvywSlA
2025-03-06 16:51:02 | INFO  | r.k.serviceImpl.CartServiceImpl | Запрос на очищение корзины
2025-03-06 16:51:02 | INFO  | r.k.serviceImpl.CartServiceImpl | Корзина очищена
2025-03-06 16:51:03 | INFO  | o.a.k.c.p.i.TransactionManager | [Producer clientId=SberSchoolShop-producer-1] ProducerId set to 0 with epoch 0
2025-03-06 16:51:03 | INFO  | o.a.k.c.p.i.TransactionManager | [Producer clientId=SberSchoolShop-producer-1] ProducerId set to 1 with epoch 0
2025-03-06 16:51:03 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 16:51:03 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/payment/19?addressId=1 | RequestID=0753699e-26dd-4ebb-a13b-a31875926f6e | Время=2025-03-06T13:51:02.669581Z | Длительность=406мс | Операция=PAYMENT_ORDER | Статус=200
2025-03-06 16:51:03 | INFO  | r.k.k.c.InventoryEventListener | Обновлен остаток товара с id 7
2025-03-06 16:51:04 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 16:51:04 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 16:51:04 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 16:51:06 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 16:51:06 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 16:51:06 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 16:51:07 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 16:51:07 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 16:51:07 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 16:51:09 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 16:51:09 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 16:51:09 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 16:51:11 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 16:51:11 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 16:51:11 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 16:51:12 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 16:51:12 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 16:51:12 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 16:56:12 | WARN  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] consumer poll timeout has expired. This means the time between subsequent calls to poll() was longer than the configured max.poll.interval.ms, which typically implies that the poll loop is spending too much time processing messages. You can address this either by increasing max.poll.interval.ms or by reducing the maximum size of batches returned in poll() with max.poll.records.
2025-03-06 16:56:12 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Member consumer-email-group-1-541d2c21-00b8-415c-9ed6-4a71c013c794 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to consumer poll timeout has expired.
2025-03-06 16:56:12 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 16:56:12 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 16:57:51 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/products | RequestID=b0ad5c94-92e9-479e-bf29-a497d527218c | Время=2025-03-06T13:57:51.223827Z | Операция=ADD_PRODUCT
2025-03-06 16:57:51 | INFO  | r.k.controllers.ProductController | Запрос на добавление товара
2025-03-06 16:57:51 | INFO  | r.k.serviceImpl.ProductServiceImpl | Создание нового товара
2025-03-06 16:57:52 | ERROR | r.k.serviceImpl.ProductServiceImpl | Пользователь не является продавцом
2025-03-06 16:57:52 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/products | RequestID=b0ad5c94-92e9-479e-bf29-a497d527218c | Время=2025-03-06T13:57:51.223827Z | Длительность=1623мс | Операция=ADD_PRODUCT | Статус=403
2025-03-06 16:58:14 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node -1 disconnected.
2025-03-06 16:58:22 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/roles/seller | RequestID=58370bae-03c4-4c70-984f-d4b820af23ad | Время=2025-03-06T13:58:22.165751Z | Операция=UNKNOWN_OPERATION
2025-03-06 16:58:22 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/roles/seller | RequestID=58370bae-03c4-4c70-984f-d4b820af23ad | Время=2025-03-06T13:58:22.165751Z | Длительность=58мс | Операция=UNKNOWN_OPERATION | Статус=404
2025-03-06 16:58:38 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/role/seller | RequestID=4dd545c0-90e6-4d35-97f0-dad827bec57b | Время=2025-03-06T13:58:38.585143Z | Операция=PURCHASE_SELLER_ROLE
2025-03-06 16:58:38 | INFO  | r.k.controllers.RoleController | Запрос на покупку роли BUYER
2025-03-06 16:58:38 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь пытается купить роль BUYER
2025-03-06 16:58:38 | INFO  | r.k.stubService.PaymentServiceImpl | Попытка списания 999.99 с кошелька пользователя denis12
2025-03-06 16:58:38 | INFO  | r.k.stubService.PaymentServiceImpl | Успешное списание 999.99 с кошелька пользователя denis12. Новый баланс: 77530.01
2025-03-06 16:58:38 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь успешно приобрел роль SELLER
2025-03-06 16:58:39 | WARN  | o.h.e.jdbc.spi.SqlExceptionHelper | SQL Error: 0, SQLState: 23505
2025-03-06 16:58:39 | ERROR | o.h.e.jdbc.spi.SqlExceptionHelper | ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(1, 2) already exists.
2025-03-06 16:58:39 | ERROR | o.a.c.c.C.[.[.[.[dispatcherServlet] | Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(1, 2) already exists.] [insert into users_roles (user_id,role_id) values (?,?)]; SQL [insert into users_roles (user_id,role_id) values (?,?)]; constraint [users_roles_pkey]] with root cause
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(1, 2) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.collection.mutation.InsertRowsCoordinatorStandard.insertRows(InsertRowsCoordinatorStandard.java:117)
	at org.hibernate.persister.collection.BasicCollectionPersister.insertRows(BasicCollectionPersister.java:122)
	at org.hibernate.action.internal.CollectionUpdateAction.execute(CollectionUpdateAction.java:86)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:727)
	at ru.kalimulin.serviceImpl.RoleServiceImpl$$SpringCGLIB$$0.purchaseSellerRole(<generated>)
	at ru.kalimulin.controllers.RoleController.purchaseSellerRole(RoleController.java:37)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:257)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:190)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1088)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:978)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at ru.kalimulin.loggerConfig.RequestLoggingFilter.doFilter(RequestLoggingFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:397)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-03-06 16:58:57 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/role/seller | RequestID=d9bf7e0f-09fd-4b4f-994b-24e6e9c380ff | Время=2025-03-06T13:58:57.749286Z | Операция=PURCHASE_SELLER_ROLE
2025-03-06 16:58:57 | INFO  | r.k.controllers.RoleController | Запрос на покупку роли BUYER
2025-03-06 16:58:57 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь пытается купить роль BUYER
2025-03-06 16:58:57 | INFO  | r.k.stubService.PaymentServiceImpl | Попытка списания 999.99 с кошелька пользователя denis12
2025-03-06 16:58:57 | INFO  | r.k.stubService.PaymentServiceImpl | Успешное списание 999.99 с кошелька пользователя denis12. Новый баланс: 77530.01
2025-03-06 16:58:57 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь успешно приобрел роль SELLER
2025-03-06 16:58:57 | WARN  | o.h.e.jdbc.spi.SqlExceptionHelper | SQL Error: 0, SQLState: 23505
2025-03-06 16:58:57 | ERROR | o.h.e.jdbc.spi.SqlExceptionHelper | ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(1, 2) already exists.
2025-03-06 16:58:57 | ERROR | o.a.c.c.C.[.[.[.[dispatcherServlet] | Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(1, 2) already exists.] [insert into users_roles (user_id,role_id) values (?,?)]; SQL [insert into users_roles (user_id,role_id) values (?,?)]; constraint [users_roles_pkey]] with root cause
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(1, 2) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.collection.mutation.InsertRowsCoordinatorStandard.insertRows(InsertRowsCoordinatorStandard.java:117)
	at org.hibernate.persister.collection.BasicCollectionPersister.insertRows(BasicCollectionPersister.java:122)
	at org.hibernate.action.internal.CollectionUpdateAction.execute(CollectionUpdateAction.java:86)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:727)
	at ru.kalimulin.serviceImpl.RoleServiceImpl$$SpringCGLIB$$0.purchaseSellerRole(<generated>)
	at ru.kalimulin.controllers.RoleController.purchaseSellerRole(RoleController.java:37)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:257)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:190)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1088)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:978)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at ru.kalimulin.loggerConfig.RequestLoggingFilter.doFilter(RequestLoggingFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:397)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-03-06 17:00:02 | INFO  | o.apache.kafka.clients.NetworkClient | [Producer clientId=SberSchoolShop-producer-1] Node -1 disconnected.
2025-03-06 17:00:24 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/login | RequestID=52804c66-db04-43f1-8ac5-037f93a3a4d6 | Время=2025-03-06T14:00:24.452112Z | Операция=LOGIN_USER
2025-03-06 17:00:24 | INFO  | r.k.serviceImpl.UserServiceImpl | Попытка входа пользователя:
2025-03-06 17:00:24 | INFO  | r.k.serviceImpl.UserServiceImpl | Успешный вход
2025-03-06 17:00:24 | INFO  | r.k.controllers.AuthController | Пользователь вошел в систему
2025-03-06 17:00:24 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/login | RequestID=52804c66-db04-43f1-8ac5-037f93a3a4d6 | Время=2025-03-06T14:00:24.452112Z | Длительность=358мс | Операция=LOGIN_USER | Статус=200
2025-03-06 17:00:32 | INFO  | o.apache.kafka.clients.NetworkClient | [Producer clientId=SberSchoolShop-producer-1] Node -1 disconnected.
2025-03-06 17:00:48 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/products | RequestID=f7b5cd7b-666a-4524-a4ba-612a47f3897e | Время=2025-03-06T14:00:48.781476Z | Операция=ADD_PRODUCT
2025-03-06 17:00:48 | INFO  | r.k.controllers.ProductController | Запрос на добавление товара
2025-03-06 17:00:48 | INFO  | r.k.serviceImpl.ProductServiceImpl | Создание нового товара
2025-03-06 17:00:48 | ERROR | r.k.serviceImpl.ProductServiceImpl | Пользователь не является продавцом
2025-03-06 17:00:48 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/products | RequestID=f7b5cd7b-666a-4524-a4ba-612a47f3897e | Время=2025-03-06T14:00:48.781476Z | Длительность=14мс | Операция=ADD_PRODUCT | Статус=403
2025-03-06 17:00:58 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/role/seller | RequestID=9260e462-ffcc-4693-ad14-3bfa84711445 | Время=2025-03-06T14:00:58.342524Z | Операция=PURCHASE_SELLER_ROLE
2025-03-06 17:00:58 | INFO  | r.k.controllers.RoleController | Запрос на покупку роли BUYER
2025-03-06 17:00:58 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь пытается купить роль BUYER
2025-03-06 17:00:58 | INFO  | r.k.stubService.PaymentServiceImpl | Попытка списания 999.99 с кошелька пользователя test12
2025-03-06 17:00:58 | ERROR | r.k.stubService.PaymentServiceImpl | Ошибка: Недостаточно средств у пользователя test12. Баланс: 900.00, требуемая сумма: 999.99
2025-03-06 17:00:58 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/role/seller | RequestID=9260e462-ffcc-4693-ad14-3bfa84711445 | Время=2025-03-06T14:00:58.342524Z | Длительность=14мс | Операция=PURCHASE_SELLER_ROLE | Статус=402
2025-03-06 17:01:10 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/deposit | RequestID=c98efbc9-33f1-4541-95a2-11d39350c7be | Время=2025-03-06T14:01:10.803105Z | Операция=DEPOSIT_BALANCE
2025-03-06 17:01:10 | INFO  | r.k.controllers.WalletController | Запрос на пополнение баланса
2025-03-06 17:01:10 | INFO  | r.k.serviceImpl.WalletServiceImpl | Пополнение кошелька пользователя
2025-03-06 17:01:10 | INFO  | r.k.stubService.PaymentServiceImpl | Обработка платежа для пользователя test12 на сумму 1000
2025-03-06 17:01:10 | ERROR | r.k.stubService.PaymentServiceImpl | Ошибка обработки платежа для пользователя test12
2025-03-06 17:01:10 | ERROR | r.k.serviceImpl.WalletServiceImpl | Ошибка обработки платежа для пользователя
2025-03-06 17:01:10 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/deposit | RequestID=c98efbc9-33f1-4541-95a2-11d39350c7be | Время=2025-03-06T14:01:10.803105Z | Длительность=28мс | Операция=DEPOSIT_BALANCE | Статус=500
2025-03-06 17:01:14 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/deposit | RequestID=b054cf70-9992-4dc5-acdb-27a08f367005 | Время=2025-03-06T14:01:14.352942Z | Операция=DEPOSIT_BALANCE
2025-03-06 17:01:14 | INFO  | r.k.controllers.WalletController | Запрос на пополнение баланса
2025-03-06 17:01:14 | INFO  | r.k.serviceImpl.WalletServiceImpl | Пополнение кошелька пользователя
2025-03-06 17:01:14 | INFO  | r.k.stubService.PaymentServiceImpl | Обработка платежа для пользователя test12 на сумму 1000
2025-03-06 17:01:14 | INFO  | r.k.stubService.PaymentServiceImpl | Платеж для test12 на сумму 1000 успешно обработан
2025-03-06 17:01:14 | INFO  | r.k.serviceImpl.WalletServiceImpl | Баланс пользователя успешно пополнен
2025-03-06 17:01:14 | INFO  | r.k.controllers.WalletController | Баланс успешно пополнен!
2025-03-06 17:01:14 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/deposit | RequestID=b054cf70-9992-4dc5-acdb-27a08f367005 | Время=2025-03-06T14:01:14.352942Z | Длительность=210мс | Операция=DEPOSIT_BALANCE | Статус=200
2025-03-06 17:01:22 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/products | RequestID=52c6ea84-6ebf-4239-9c1b-1fa6be691a66 | Время=2025-03-06T14:01:22.440774Z | Операция=ADD_PRODUCT
2025-03-06 17:01:22 | INFO  | r.k.controllers.ProductController | Запрос на добавление товара
2025-03-06 17:01:22 | INFO  | r.k.serviceImpl.ProductServiceImpl | Создание нового товара
2025-03-06 17:01:22 | ERROR | r.k.serviceImpl.ProductServiceImpl | Пользователь не является продавцом
2025-03-06 17:01:22 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/products | RequestID=52c6ea84-6ebf-4239-9c1b-1fa6be691a66 | Время=2025-03-06T14:01:22.440774Z | Длительность=28мс | Операция=ADD_PRODUCT | Статус=403
2025-03-06 17:01:58 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/role/seller | RequestID=1718696e-0c05-4af9-bd8f-ff3c0b867876 | Время=2025-03-06T14:01:58.559619Z | Операция=PURCHASE_SELLER_ROLE
2025-03-06 17:01:58 | INFO  | r.k.controllers.RoleController | Запрос на покупку роли BUYER
2025-03-06 17:01:58 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь пытается купить роль BUYER
2025-03-06 17:01:58 | INFO  | r.k.stubService.PaymentServiceImpl | Попытка списания 999.99 с кошелька пользователя test12
2025-03-06 17:01:58 | INFO  | r.k.stubService.PaymentServiceImpl | Успешное списание 999.99 с кошелька пользователя test12. Новый баланс: 900.01
2025-03-06 17:01:58 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь успешно приобрел роль SELLER
2025-03-06 17:01:58 | WARN  | o.h.e.jdbc.spi.SqlExceptionHelper | SQL Error: 0, SQLState: 23505
2025-03-06 17:01:58 | ERROR | o.h.e.jdbc.spi.SqlExceptionHelper | ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.
2025-03-06 17:01:58 | ERROR | o.a.c.c.C.[.[.[.[dispatcherServlet] | Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.] [insert into users_roles (user_id,role_id) values (?,?)]; SQL [insert into users_roles (user_id,role_id) values (?,?)]; constraint [users_roles_pkey]] with root cause
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.collection.mutation.InsertRowsCoordinatorStandard.insertRows(InsertRowsCoordinatorStandard.java:117)
	at org.hibernate.persister.collection.BasicCollectionPersister.insertRows(BasicCollectionPersister.java:122)
	at org.hibernate.action.internal.CollectionUpdateAction.execute(CollectionUpdateAction.java:86)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:727)
	at ru.kalimulin.serviceImpl.RoleServiceImpl$$SpringCGLIB$$0.purchaseSellerRole(<generated>)
	at ru.kalimulin.controllers.RoleController.purchaseSellerRole(RoleController.java:37)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:257)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:190)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1088)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:978)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at ru.kalimulin.loggerConfig.RequestLoggingFilter.doFilter(RequestLoggingFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:397)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-03-06 17:02:05 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/role/seller | RequestID=a80fbce0-60e5-47ef-a1bf-b8d3ed41607d | Время=2025-03-06T14:02:05.161615Z | Операция=PURCHASE_SELLER_ROLE
2025-03-06 17:02:05 | INFO  | r.k.controllers.RoleController | Запрос на покупку роли BUYER
2025-03-06 17:02:05 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь пытается купить роль BUYER
2025-03-06 17:02:05 | INFO  | r.k.stubService.PaymentServiceImpl | Попытка списания 999.99 с кошелька пользователя test12
2025-03-06 17:02:05 | INFO  | r.k.stubService.PaymentServiceImpl | Успешное списание 999.99 с кошелька пользователя test12. Новый баланс: 900.01
2025-03-06 17:02:05 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь успешно приобрел роль SELLER
2025-03-06 17:02:05 | WARN  | o.h.e.jdbc.spi.SqlExceptionHelper | SQL Error: 0, SQLState: 23505
2025-03-06 17:02:05 | ERROR | o.h.e.jdbc.spi.SqlExceptionHelper | ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.
2025-03-06 17:02:05 | ERROR | o.a.c.c.C.[.[.[.[dispatcherServlet] | Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.] [insert into users_roles (user_id,role_id) values (?,?)]; SQL [insert into users_roles (user_id,role_id) values (?,?)]; constraint [users_roles_pkey]] with root cause
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.collection.mutation.InsertRowsCoordinatorStandard.insertRows(InsertRowsCoordinatorStandard.java:117)
	at org.hibernate.persister.collection.BasicCollectionPersister.insertRows(BasicCollectionPersister.java:122)
	at org.hibernate.action.internal.CollectionUpdateAction.execute(CollectionUpdateAction.java:86)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:727)
	at ru.kalimulin.serviceImpl.RoleServiceImpl$$SpringCGLIB$$0.purchaseSellerRole(<generated>)
	at ru.kalimulin.controllers.RoleController.purchaseSellerRole(RoleController.java:37)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:257)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:190)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1088)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:978)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at ru.kalimulin.loggerConfig.RequestLoggingFilter.doFilter(RequestLoggingFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:397)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-03-06 17:02:20 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/role/seller | RequestID=3d0ef7c8-d865-43b4-8ed8-844a2af41001 | Время=2025-03-06T14:02:20.228471Z | Операция=PURCHASE_SELLER_ROLE
2025-03-06 17:02:20 | INFO  | r.k.controllers.RoleController | Запрос на покупку роли BUYER
2025-03-06 17:02:20 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь пытается купить роль BUYER
2025-03-06 17:02:20 | INFO  | r.k.stubService.PaymentServiceImpl | Попытка списания 999.99 с кошелька пользователя test12
2025-03-06 17:02:20 | INFO  | r.k.stubService.PaymentServiceImpl | Успешное списание 999.99 с кошелька пользователя test12. Новый баланс: 900.01
2025-03-06 17:02:20 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь успешно приобрел роль SELLER
2025-03-06 17:02:20 | WARN  | o.h.e.jdbc.spi.SqlExceptionHelper | SQL Error: 0, SQLState: 23505
2025-03-06 17:02:20 | ERROR | o.h.e.jdbc.spi.SqlExceptionHelper | ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.
2025-03-06 17:02:20 | ERROR | o.a.c.c.C.[.[.[.[dispatcherServlet] | Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.] [insert into users_roles (user_id,role_id) values (?,?)]; SQL [insert into users_roles (user_id,role_id) values (?,?)]; constraint [users_roles_pkey]] with root cause
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.collection.mutation.InsertRowsCoordinatorStandard.insertRows(InsertRowsCoordinatorStandard.java:117)
	at org.hibernate.persister.collection.BasicCollectionPersister.insertRows(BasicCollectionPersister.java:122)
	at org.hibernate.action.internal.CollectionUpdateAction.execute(CollectionUpdateAction.java:86)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:727)
	at ru.kalimulin.serviceImpl.RoleServiceImpl$$SpringCGLIB$$0.purchaseSellerRole(<generated>)
	at ru.kalimulin.controllers.RoleController.purchaseSellerRole(RoleController.java:37)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:257)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:190)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1088)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:978)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at ru.kalimulin.loggerConfig.RequestLoggingFilter.doFilter(RequestLoggingFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:397)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-03-06 17:03:52 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/users/me | RequestID=1a1c6e0d-af29-47c2-92e4-2b0b6180b705 | Время=2025-03-06T14:03:52.558973Z | Операция=UNKNOWN_OPERATION
2025-03-06 17:03:52 | WARN  | o.s.w.s.m.s.DefaultHandlerExceptionResolver | Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'POST' is not supported]
2025-03-06 17:03:52 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/users/me | RequestID=1a1c6e0d-af29-47c2-92e4-2b0b6180b705 | Время=2025-03-06T14:03:52.558973Z | Длительность=23мс | Операция=UNKNOWN_OPERATION | Статус=405
2025-03-06 17:03:57 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/users/profile | RequestID=67b1ab61-57a2-492f-bd87-39edd9cab6b7 | Время=2025-03-06T14:03:57.118135Z | Операция=UNKNOWN_OPERATION
2025-03-06 17:03:57 | WARN  | o.s.w.s.m.s.DefaultHandlerExceptionResolver | Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'POST' is not supported]
2025-03-06 17:03:57 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/users/profile | RequestID=67b1ab61-57a2-492f-bd87-39edd9cab6b7 | Время=2025-03-06T14:03:57.118135Z | Длительность=3мс | Операция=UNKNOWN_OPERATION | Статус=405
2025-03-06 17:04:01 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/profile | RequestID=56f8e3d1-3666-49f3-b0c5-857d034223b6 | Время=2025-03-06T14:04:01.315379Z | Операция=UNKNOWN_OPERATION
2025-03-06 17:04:01 | WARN  | o.s.w.s.m.s.DefaultHandlerExceptionResolver | Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'POST' is not supported]
2025-03-06 17:04:01 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/profile | RequestID=56f8e3d1-3666-49f3-b0c5-857d034223b6 | Время=2025-03-06T14:04:01.315379Z | Длительность=4мс | Операция=UNKNOWN_OPERATION | Статус=405
2025-03-06 17:04:35 | INFO  | r.k.l.RequestLoggingFilter | Запрос: GET /shop/auth/profile | RequestID=31252ec7-3566-4091-ba2e-5a44086be866 | Время=2025-03-06T14:04:35.351148Z | Операция=UNKNOWN_OPERATION
2025-03-06 17:04:35 | INFO  | r.k.controllers.AuthController | Запрос на получение профиля
2025-03-06 17:04:35 | INFO  | r.k.serviceImpl.UserServiceImpl | Получение профиля текущего пользователя
2025-03-06 17:04:35 | INFO  | r.k.l.RequestLoggingFilter | Ответ: GET /shop/auth/profile | RequestID=31252ec7-3566-4091-ba2e-5a44086be866 | Время=2025-03-06T14:04:35.351148Z | Длительность=90мс | Операция=UNKNOWN_OPERATION | Статус=200
2025-03-06 17:04:49 | INFO  | r.k.l.RequestLoggingFilter | Запрос: GET /shop/wallet | RequestID=fc5c0337-b1a7-49d6-891e-acfe56e9107b | Время=2025-03-06T14:04:49.407023Z | Операция=UNKNOWN_OPERATION
2025-03-06 17:04:49 | INFO  | r.k.controllers.WalletController | Запрос на получение данных кошелька пользователя
2025-03-06 17:04:49 | INFO  | r.k.serviceImpl.WalletServiceImpl | Запрос кошелька
2025-03-06 17:04:49 | INFO  | r.k.l.RequestLoggingFilter | Ответ: GET /shop/wallet | RequestID=fc5c0337-b1a7-49d6-891e-acfe56e9107b | Время=2025-03-06T14:04:49.407023Z | Длительность=39мс | Операция=UNKNOWN_OPERATION | Статус=200
2025-03-06 17:04:59 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/role/seller | RequestID=6ffbf341-7067-4071-b943-6031edde86c2 | Время=2025-03-06T14:04:59.473651Z | Операция=PURCHASE_SELLER_ROLE
2025-03-06 17:04:59 | INFO  | r.k.controllers.RoleController | Запрос на покупку роли BUYER
2025-03-06 17:04:59 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь пытается купить роль BUYER
2025-03-06 17:04:59 | INFO  | r.k.stubService.PaymentServiceImpl | Попытка списания 999.99 с кошелька пользователя test12
2025-03-06 17:04:59 | INFO  | r.k.stubService.PaymentServiceImpl | Успешное списание 999.99 с кошелька пользователя test12. Новый баланс: 900.01
2025-03-06 17:04:59 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь успешно приобрел роль SELLER
2025-03-06 17:04:59 | WARN  | o.h.e.jdbc.spi.SqlExceptionHelper | SQL Error: 0, SQLState: 23505
2025-03-06 17:04:59 | ERROR | o.h.e.jdbc.spi.SqlExceptionHelper | ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.
2025-03-06 17:04:59 | ERROR | o.a.c.c.C.[.[.[.[dispatcherServlet] | Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.] [insert into users_roles (user_id,role_id) values (?,?)]; SQL [insert into users_roles (user_id,role_id) values (?,?)]; constraint [users_roles_pkey]] with root cause
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.collection.mutation.InsertRowsCoordinatorStandard.insertRows(InsertRowsCoordinatorStandard.java:117)
	at org.hibernate.persister.collection.BasicCollectionPersister.insertRows(BasicCollectionPersister.java:122)
	at org.hibernate.action.internal.CollectionUpdateAction.execute(CollectionUpdateAction.java:86)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:727)
	at ru.kalimulin.serviceImpl.RoleServiceImpl$$SpringCGLIB$$0.purchaseSellerRole(<generated>)
	at ru.kalimulin.controllers.RoleController.purchaseSellerRole(RoleController.java:37)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:257)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:190)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1088)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:978)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at ru.kalimulin.loggerConfig.RequestLoggingFilter.doFilter(RequestLoggingFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:397)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-03-06 17:05:46 | INFO  | r.k.l.RequestLoggingFilter | Запрос: GET /shop/wallet | RequestID=61e84cbd-74f0-438a-82f1-e40f4e59ab04 | Время=2025-03-06T14:05:46.958362Z | Операция=UNKNOWN_OPERATION
2025-03-06 17:05:46 | INFO  | r.k.controllers.WalletController | Запрос на получение данных кошелька пользователя
2025-03-06 17:05:46 | INFO  | r.k.serviceImpl.WalletServiceImpl | Запрос кошелька
2025-03-06 17:05:46 | INFO  | r.k.l.RequestLoggingFilter | Ответ: GET /shop/wallet | RequestID=61e84cbd-74f0-438a-82f1-e40f4e59ab04 | Время=2025-03-06T14:05:46.958362Z | Длительность=24мс | Операция=UNKNOWN_OPERATION | Статус=200
2025-03-06 17:07:16 | INFO  | r.k.l.RequestLoggingFilter | Запрос: GET /shop/auth/profile | RequestID=80cf8780-0b06-45f0-ab52-f4f06e541f0a | Время=2025-03-06T14:07:16.067853Z | Операция=UNKNOWN_OPERATION
2025-03-06 17:07:16 | INFO  | r.k.controllers.AuthController | Запрос на получение профиля
2025-03-06 17:07:16 | INFO  | r.k.serviceImpl.UserServiceImpl | Получение профиля текущего пользователя
2025-03-06 17:07:16 | INFO  | r.k.l.RequestLoggingFilter | Ответ: GET /shop/auth/profile | RequestID=80cf8780-0b06-45f0-ab52-f4f06e541f0a | Время=2025-03-06T14:07:16.067853Z | Длительность=54мс | Операция=UNKNOWN_OPERATION | Статус=200
2025-03-06 17:08:14 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node -1 disconnected.
2025-03-06 17:10:02 | INFO  | o.apache.kafka.clients.NetworkClient | [Producer clientId=SberSchoolShop-producer-1] Node -1 disconnected.
2025-03-06 17:10:02 | INFO  | o.apache.kafka.clients.NetworkClient | [Producer clientId=SberSchoolShop-producer-1] Node -1 disconnected.
2025-03-06 17:13:45 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Revoke previously assigned partitions inventory-updates-0
2025-03-06 17:13:45 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: partitions revoked: [inventory-updates-0]
2025-03-06 17:13:45 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Member consumer-inventory-group-2-93739533-db5b-4225-ac95-b2309874209a sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-03-06 17:13:45 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 17:13:45 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 17:13:45 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Unsubscribed all topics or patterns and assigned partitions
2025-03-06 17:13:45 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 17:13:45 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 17:13:45 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 17:13:45 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 17:13:45 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 17:13:45 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 17:13:45 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.consumer for consumer-inventory-group-2 unregistered
2025-03-06 17:13:45 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: Consumer stopped
2025-03-06 17:14:15 | INFO  | o.s.c.s.DefaultLifecycleProcessor | Shutdown phase 2147483547 ends with 1 bean still running after timeout of 30000ms: [org.springframework.kafka.config.internalKafkaListenerEndpointRegistry]
2025-03-06 17:14:15 | INFO  | o.s.b.w.e.tomcat.GracefulShutdown | Commencing graceful shutdown. Waiting for active requests to complete
2025-03-06 17:14:15 | INFO  | o.s.b.w.e.tomcat.GracefulShutdown | Graceful shutdown complete
2025-03-06 17:14:15 | INFO  | o.a.k.clients.producer.KafkaProducer | [Producer clientId=SberSchoolShop-producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-03-06 17:14:15 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 17:14:15 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 17:14:15 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 17:14:15 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 17:14:15 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.producer for SberSchoolShop-producer-1 unregistered
2025-03-06 17:14:15 | INFO  | o.a.k.clients.producer.KafkaProducer | [Producer clientId=SberSchoolShop-producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-03-06 17:14:15 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 17:14:15 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 17:14:15 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 17:14:15 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 17:14:15 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.producer for SberSchoolShop-producer-1 unregistered
2025-03-06 17:14:15 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 17:14:15 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown initiated...
2025-03-06 17:14:15 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown completed.
2025-03-06 17:14:20 | INFO  | o.h.validator.internal.util.Version | HV000001: Hibernate Validator 8.0.2.Final
2025-03-06 17:14:20 | INFO  | ru.kalimulin.SberSchoolShop | Starting SberSchoolShop using Java 17.0.11 with PID 76368 (/Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop/web/target/classes started by deniskalimulin in /Users/deniskalimulin/IdeaProjects/Test/SberSchoolShop)
2025-03-06 17:14:20 | INFO  | ru.kalimulin.SberSchoolShop | No active profile set, falling back to 1 default profile: "default"
2025-03-06 17:14:20 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-06 17:14:20 | INFO  | o.s.d.r.c.RepositoryConfigurationDelegate | Finished Spring Data repository scanning in 82 ms. Found 13 JPA repository interfaces.
2025-03-06 17:14:21 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat initialized with port 8080 (http)
2025-03-06 17:14:21 | INFO  | o.a.coyote.http11.Http11NioProtocol | Initializing ProtocolHandler ["http-nio-8080"]
2025-03-06 17:14:21 | INFO  | o.a.catalina.core.StandardService | Starting service [Tomcat]
2025-03-06 17:14:21 | INFO  | o.a.catalina.core.StandardEngine | Starting Servlet engine: [Apache Tomcat/10.1.34]
2025-03-06 17:14:21 | INFO  | o.a.c.c.C.[Tomcat].[localhost].[/] | Initializing Spring embedded WebApplicationContext
2025-03-06 17:14:21 | INFO  | o.s.b.w.s.c.ServletWebServerApplicationContext | Root WebApplicationContext: initialization completed in 1667 ms
2025-03-06 17:14:21 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Starting...
2025-03-06 17:14:22 | INFO  | com.zaxxer.hikari.pool.HikariPool | HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@27d98bef
2025-03-06 17:14:22 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Start completed.
2025-03-06 17:14:23 | INFO  | o.h.jpa.internal.util.LogHelper | HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-06 17:14:23 | INFO  | org.hibernate.Version | HHH000412: Hibernate ORM core version 6.6.5.Final
2025-03-06 17:14:23 | INFO  | o.h.c.i.RegionFactoryInitiator | HHH000026: Second-level cache disabled
2025-03-06 17:14:23 | INFO  | o.s.o.j.p.SpringPersistenceUnitInfo | No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-06 17:14:24 | WARN  | org.hibernate.orm.deprecation | HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-03-06 17:14:24 | INFO  | o.hibernate.orm.connections.pooling | HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 16.3
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-03-06 17:14:25 | INFO  | o.h.e.t.j.p.i.JtaPlatformInitiator | HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-03-06 17:14:25 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 17:14:25 | INFO  | o.s.d.j.r.query.QueryEnhancerFactory | Hibernate is in classpath; If applicable, HQL parser will be used.
2025-03-06 17:14:26 | INFO  | o.a.coyote.http11.Http11NioProtocol | Starting ProtocolHandler ["http-nio-8080"]
2025-03-06 17:14:26 | INFO  | o.s.b.w.e.tomcat.TomcatWebServer | Tomcat started on port 8080 (http) with context path '/'
2025-03-06 17:14:26 | INFO  | o.a.k.c.consumer.ConsumerConfig | ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-email-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = email-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-03-06 17:14:26 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 17:14:26 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 17:14:26 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 17:14:26 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741270466401
2025-03-06 17:14:26 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Subscribed to topic(s): email-notifications
2025-03-06 17:14:26 | INFO  | o.a.k.c.consumer.ConsumerConfig | ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = latest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-inventory-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = inventory-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-03-06 17:14:26 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 17:14:26 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 17:14:26 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 17:14:26 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741270466412
2025-03-06 17:14:26 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Subscribed to topic(s): inventory-updates
2025-03-06 17:14:26 | INFO  | ru.kalimulin.SberSchoolShop | Started SberSchoolShop in 7.118 seconds (process running for 7.68)
2025-03-06 17:14:26 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Cluster ID: 8qJM25-_Sz2H6XnzvywSlA
2025-03-06 17:14:26 | INFO  | org.apache.kafka.clients.Metadata | [Consumer clientId=consumer-email-group-1, groupId=email-group] Cluster ID: 8qJM25-_Sz2H6XnzvywSlA
2025-03-06 17:14:26 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-03-06 17:14:26 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-03-06 17:14:26 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 17:14:26 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] (Re-)joining group
2025-03-06 17:14:26 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: need to re-join with the given member-id: consumer-email-group-1-37b27ca4-6656-4f29-93aa-f2c21a3bf7d5
2025-03-06 17:14:26 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: need to re-join with the given member-id: consumer-inventory-group-2-2c962cb8-f51e-4a8a-9dd8-2fed066e37c4
2025-03-06 17:14:26 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] (Re-)joining group
2025-03-06 17:14:26 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] (Re-)joining group
2025-03-06 17:14:29 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Successfully joined group with generation Generation{generationId=5, memberId='consumer-inventory-group-2-2c962cb8-f51e-4a8a-9dd8-2fed066e37c4', protocol='range'}
2025-03-06 17:14:29 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully joined group with generation Generation{generationId=5, memberId='consumer-email-group-1-37b27ca4-6656-4f29-93aa-f2c21a3bf7d5', protocol='range'}
2025-03-06 17:14:29 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Finished assignment for group at generation 5: {consumer-email-group-1-37b27ca4-6656-4f29-93aa-f2c21a3bf7d5=Assignment(partitions=[email-notifications-0])}
2025-03-06 17:14:29 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Finished assignment for group at generation 5: {consumer-inventory-group-2-2c962cb8-f51e-4a8a-9dd8-2fed066e37c4=Assignment(partitions=[inventory-updates-0])}
2025-03-06 17:14:29 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Successfully synced group in generation Generation{generationId=5, memberId='consumer-email-group-1-37b27ca4-6656-4f29-93aa-f2c21a3bf7d5', protocol='range'}
2025-03-06 17:14:29 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Successfully synced group in generation Generation{generationId=5, memberId='consumer-inventory-group-2-2c962cb8-f51e-4a8a-9dd8-2fed066e37c4', protocol='range'}
2025-03-06 17:14:29 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Notifying assignor about the new Assignment(partitions=[inventory-updates-0])
2025-03-06 17:14:29 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Notifying assignor about the new Assignment(partitions=[email-notifications-0])
2025-03-06 17:14:29 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Adding newly assigned partitions: inventory-updates-0
2025-03-06 17:14:29 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Adding newly assigned partitions: email-notifications-0
2025-03-06 17:14:30 | INFO  | o.a.k.c.c.internals.ConsumerUtils | Setting offset for partition inventory-updates-0 to the committed offset FetchPosition{offset=1, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-03-06 17:14:30 | INFO  | o.a.k.c.c.internals.ConsumerUtils | Setting offset for partition email-notifications-0 to the committed offset FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=0}}
2025-03-06 17:14:30 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: partitions assigned: [inventory-updates-0]
2025-03-06 17:14:30 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions assigned: [email-notifications-0]
2025-03-06 17:14:30 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:14:31 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 17:14:31 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 17:14:31 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:14:33 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 17:14:33 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 17:14:33 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:14:34 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 17:14:34 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 17:14:34 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:14:36 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 17:14:36 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 17:14:36 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:14:37 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 17:14:37 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 17:14:37 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:14:39 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 17:14:39 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 17:14:39 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:14:40 | INFO  | o.a.c.c.C.[Tomcat].[localhost].[/] | Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-03-06 17:14:40 | INFO  | o.s.web.servlet.DispatcherServlet | Initializing Servlet 'dispatcherServlet'
2025-03-06 17:14:40 | INFO  | o.s.web.servlet.DispatcherServlet | Completed initialization in 4 ms
2025-03-06 17:14:40 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/login | RequestID=1b7f041b-20cd-41ed-86b3-edf30638f3f7 | Время=2025-03-06T14:14:40.022547Z | Операция=LOGIN_USER
2025-03-06 17:14:40 | INFO  | r.k.serviceImpl.UserServiceImpl | Попытка входа пользователя:
2025-03-06 17:14:40 | INFO  | r.k.serviceImpl.UserServiceImpl | Успешный вход
2025-03-06 17:14:40 | INFO  | r.k.controllers.AuthController | Пользователь вошел в систему
2025-03-06 17:14:40 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/login | RequestID=1b7f041b-20cd-41ed-86b3-edf30638f3f7 | Время=2025-03-06T14:14:40.022547Z | Длительность=734мс | Операция=LOGIN_USER | Статус=200
2025-03-06 17:14:40 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 17:14:40 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 17:14:40 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:14:42 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 17:14:42 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 17:14:42 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:14:44 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Seeking to offset 0 for partition email-notifications-0
2025-03-06 17:14:44 | INFO  | o.s.k.l.KafkaMessageListenerContainer | Record in retry and not yet recovered
2025-03-06 17:14:44 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:14:45 | ERROR | o.s.k.listener.DefaultErrorHandler | Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for email-notifications-0@0
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void ru.kalimulin.kafka.consumers.EmailEventListener.listen(ru.kalimulin.dto.kafkaEventDTO.EmailNotificationEvent)' threw exception
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2989)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2896)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2860)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2772)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2609)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2498)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2149)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1525)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1463)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1332)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)
	at java.base/java.lang.Thread.run(Thread.java:840)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:489)
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:421)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2882)
Caused by: org.springframework.mail.MailSendException: Mail server connection failed. Failed messages: jakarta.mail.MessagingException: Exception reading response;
  nested exception is:
	java.net.SocketException: Connection reset
	at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:410)
	at org.springframework.mail.javamail.JavaMailSenderImpl.send(JavaMailSenderImpl.java:317)
	at org.springframework.mail.MailSender.send(MailSender.java:42)
	at ru.kalimulin.mail.EmailSenderImpl.sendEmail(EmailSenderImpl.java:33)
	at ru.kalimulin.mail.EmailSenderImpl.sendOrderNotification(EmailSenderImpl.java:24)
	at ru.kalimulin.kafka.consumers.EmailEventListener.listen(EmailEventListener.java:21)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:71)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:474)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:421)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2882)
	... 10 common frames omitted
Caused by: jakarta.mail.MessagingException: Exception reading response
	at org.eclipse.angus.mail.smtp.SMTPTransport.readServerResponse(SMTPTransport.java:2509)
	at org.eclipse.angus.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:2205)
	at org.eclipse.angus.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:729)
	at jakarta.mail.Service.connect(Service.java:345)
	at org.springframework.mail.javamail.JavaMailSenderImpl.connectTransport(JavaMailSenderImpl.java:480)
	at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:399)
	... 28 common frames omitted
Caused by: java.net.SocketException: Connection reset
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:328)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:355)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:808)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:966)
	at org.eclipse.angus.mail.util.TraceInputStream.read(TraceInputStream.java:107)
	at java.base/java.io.BufferedInputStream.fill(BufferedInputStream.java:244)
	at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:263)
	at org.eclipse.angus.mail.util.LineInputStream.readLine(LineInputStream.java:104)
	at org.eclipse.angus.mail.smtp.SMTPTransport.readServerResponse(SMTPTransport.java:2489)
	... 33 common frames omitted
2025-03-06 17:15:00 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/profile | RequestID=c6b51cb1-c020-4bd6-9509-7b6675635041 | Время=2025-03-06T14:15:00.516949Z | Операция=UNKNOWN_OPERATION
2025-03-06 17:15:00 | WARN  | o.s.w.s.m.s.DefaultHandlerExceptionResolver | Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'POST' is not supported]
2025-03-06 17:15:00 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/profile | RequestID=c6b51cb1-c020-4bd6-9509-7b6675635041 | Время=2025-03-06T14:15:00.516949Z | Длительность=23мс | Операция=UNKNOWN_OPERATION | Статус=405
2025-03-06 17:15:10 | INFO  | r.k.l.RequestLoggingFilter | Запрос: GET /shop/auth/profile | RequestID=ce324807-e8ce-46ef-9170-7a4e1f15d897 | Время=2025-03-06T14:15:10.757252Z | Операция=UNKNOWN_OPERATION
2025-03-06 17:15:10 | INFO  | r.k.controllers.AuthController | Запрос на получение профиля
2025-03-06 17:15:10 | INFO  | r.k.serviceImpl.UserServiceImpl | Получение профиля текущего пользователя
2025-03-06 17:15:10 | INFO  | r.k.l.RequestLoggingFilter | Ответ: GET /shop/auth/profile | RequestID=ce324807-e8ce-46ef-9170-7a4e1f15d897 | Время=2025-03-06T14:15:10.757252Z | Длительность=71мс | Операция=UNKNOWN_OPERATION | Статус=200
2025-03-06 17:15:26 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/role/seller | RequestID=e9bf89ec-f7ac-4fae-9ddb-682967c40816 | Время=2025-03-06T14:15:26.854966Z | Операция=PURCHASE_SELLER_ROLE
2025-03-06 17:15:26 | INFO  | r.k.controllers.RoleController | Запрос на покупку роли BUYER
2025-03-06 17:15:26 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь пытается купить роль SELLER
2025-03-06 17:15:26 | INFO  | r.k.stubService.PaymentServiceImpl | Попытка списания 999.99 с кошелька пользователя test12
2025-03-06 17:15:26 | INFO  | r.k.stubService.PaymentServiceImpl | Успешное списание 999.99 с кошелька пользователя test12. Новый баланс: 900.01
2025-03-06 17:15:26 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь успешно приобрел роль SELLER
2025-03-06 17:15:27 | WARN  | o.h.e.jdbc.spi.SqlExceptionHelper | SQL Error: 0, SQLState: 23505
2025-03-06 17:15:27 | ERROR | o.h.e.jdbc.spi.SqlExceptionHelper | ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.
2025-03-06 17:15:27 | ERROR | o.a.c.c.C.[.[.[.[dispatcherServlet] | Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.] [insert into users_roles (user_id,role_id) values (?,?)]; SQL [insert into users_roles (user_id,role_id) values (?,?)]; constraint [users_roles_pkey]] with root cause
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "users_roles_pkey"
  Подробности: Key (user_id, role_id)=(7, 2) already exists.
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2733)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2420)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:517)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:434)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.collection.mutation.InsertRowsCoordinatorStandard.insertRows(InsertRowsCoordinatorStandard.java:117)
	at org.hibernate.persister.collection.BasicCollectionPersister.insertRows(BasicCollectionPersister.java:122)
	at org.hibernate.action.internal.CollectionUpdateAction.execute(CollectionUpdateAction.java:86)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:562)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:727)
	at ru.kalimulin.serviceImpl.RoleServiceImpl$$SpringCGLIB$$0.purchaseSellerRole(<generated>)
	at ru.kalimulin.controllers.RoleController.purchaseSellerRole(RoleController.java:37)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:257)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:190)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1088)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:978)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at ru.kalimulin.loggerConfig.RequestLoggingFilter.doFilter(RequestLoggingFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:397)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-03-06 17:16:35 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/logout | RequestID=e16f2b47-a718-46e1-8d7f-a70cb296ead0 | Время=2025-03-06T14:16:35.426515Z | Операция=LOGOUT_USER
2025-03-06 17:16:35 | INFO  | r.k.controllers.AuthController | Пользователь вышел из системы
2025-03-06 17:16:35 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/logout | RequestID=e16f2b47-a718-46e1-8d7f-a70cb296ead0 | Время=2025-03-06T14:16:35.426515Z | Длительность=16мс | Операция=LOGOUT_USER | Статус=200
2025-03-06 17:17:07 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/register | RequestID=b972bc46-2b69-4289-afa6-b5e58c653d0d | Время=2025-03-06T14:17:07.125905Z | Операция=REGISTER_USER
2025-03-06 17:17:07 | INFO  | r.k.serviceImpl.UserServiceImpl | Регистрация нового пользователя
2025-03-06 17:17:07 | INFO  | r.k.serviceImpl.UserServiceImpl | Пользователь зарегистрирован
2025-03-06 17:17:07 | INFO  | r.k.controllers.AuthController | Новый пользователь зарегистрирован
2025-03-06 17:17:07 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/register | RequestID=b972bc46-2b69-4289-afa6-b5e58c653d0d | Время=2025-03-06T14:17:07.125905Z | Длительность=572мс | Операция=REGISTER_USER | Статус=201
2025-03-06 17:17:54 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/login | RequestID=7d4ad865-d39b-47d5-bfc1-cde8a7b116bc | Время=2025-03-06T14:17:54.192930Z | Операция=LOGIN_USER
2025-03-06 17:17:54 | INFO  | r.k.serviceImpl.UserServiceImpl | Попытка входа пользователя:
2025-03-06 17:17:54 | INFO  | r.k.serviceImpl.UserServiceImpl | Успешный вход
2025-03-06 17:17:54 | INFO  | r.k.controllers.AuthController | Пользователь вошел в систему
2025-03-06 17:17:54 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/login | RequestID=7d4ad865-d39b-47d5-bfc1-cde8a7b116bc | Время=2025-03-06T14:17:54.192930Z | Длительность=239мс | Операция=LOGIN_USER | Статус=200
2025-03-06 17:18:12 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet | RequestID=e7d7e901-1166-4737-b134-7b8219bc2ff8 | Время=2025-03-06T14:18:12.114011Z | Операция=UNKNOWN_OPERATION
2025-03-06 17:18:12 | WARN  | o.s.w.s.m.s.DefaultHandlerExceptionResolver | Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'POST' is not supported]
2025-03-06 17:18:12 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet | RequestID=e7d7e901-1166-4737-b134-7b8219bc2ff8 | Время=2025-03-06T14:18:12.114011Z | Длительность=7мс | Операция=UNKNOWN_OPERATION | Статус=405
2025-03-06 17:18:18 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/create | RequestID=af3025f1-fdbe-42ea-907c-b486c12d3bd0 | Время=2025-03-06T14:18:18.289800Z | Операция=CREATE_WALLET
2025-03-06 17:18:18 | INFO  | r.k.controllers.WalletController | Запрос на создание нового кошелька
2025-03-06 17:18:18 | INFO  | r.k.serviceImpl.WalletServiceImpl | Создание нового кошелька для пользователя
2025-03-06 17:18:18 | INFO  | r.k.serviceImpl.WalletServiceImpl | Кошелек создан
2025-03-06 17:18:18 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/create | RequestID=af3025f1-fdbe-42ea-907c-b486c12d3bd0 | Время=2025-03-06T14:18:18.289800Z | Длительность=203мс | Операция=CREATE_WALLET | Статус=201
2025-03-06 17:18:36 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/deposit | RequestID=6895d5c1-b499-419f-898c-bbf0bd1c4cce | Время=2025-03-06T14:18:36.542680Z | Операция=DEPOSIT_BALANCE
2025-03-06 17:18:36 | INFO  | r.k.controllers.WalletController | Запрос на пополнение баланса
2025-03-06 17:18:36 | INFO  | r.k.serviceImpl.WalletServiceImpl | Пополнение кошелька пользователя
2025-03-06 17:18:36 | INFO  | r.k.stubService.PaymentServiceImpl | Обработка платежа для пользователя inna на сумму 1000
2025-03-06 17:18:36 | ERROR | r.k.stubService.PaymentServiceImpl | Ошибка обработки платежа для пользователя inna
2025-03-06 17:18:36 | ERROR | r.k.serviceImpl.WalletServiceImpl | Ошибка обработки платежа для пользователя
2025-03-06 17:18:36 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/deposit | RequestID=6895d5c1-b499-419f-898c-bbf0bd1c4cce | Время=2025-03-06T14:18:36.542680Z | Длительность=61мс | Операция=DEPOSIT_BALANCE | Статус=500
2025-03-06 17:18:38 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/wallet/deposit | RequestID=40e2b1f8-65c5-4a89-8c1e-e66de85f03b7 | Время=2025-03-06T14:18:38.116178Z | Операция=DEPOSIT_BALANCE
2025-03-06 17:18:38 | INFO  | r.k.controllers.WalletController | Запрос на пополнение баланса
2025-03-06 17:18:38 | INFO  | r.k.serviceImpl.WalletServiceImpl | Пополнение кошелька пользователя
2025-03-06 17:18:38 | INFO  | r.k.stubService.PaymentServiceImpl | Обработка платежа для пользователя inna на сумму 1000
2025-03-06 17:18:38 | INFO  | r.k.stubService.PaymentServiceImpl | Платеж для inna на сумму 1000 успешно обработан
2025-03-06 17:18:38 | INFO  | r.k.serviceImpl.WalletServiceImpl | Баланс пользователя успешно пополнен
2025-03-06 17:18:38 | INFO  | r.k.controllers.WalletController | Баланс успешно пополнен!
2025-03-06 17:18:38 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/wallet/deposit | RequestID=40e2b1f8-65c5-4a89-8c1e-e66de85f03b7 | Время=2025-03-06T14:18:38.116178Z | Длительность=189мс | Операция=DEPOSIT_BALANCE | Статус=200
2025-03-06 17:18:51 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/role/seller | RequestID=ef315ac8-d678-4aa7-b38b-8866501ba9b2 | Время=2025-03-06T14:18:51.723757Z | Операция=PURCHASE_SELLER_ROLE
2025-03-06 17:18:51 | INFO  | r.k.controllers.RoleController | Запрос на покупку роли BUYER
2025-03-06 17:18:51 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь пытается купить роль SELLER
2025-03-06 17:18:51 | INFO  | r.k.stubService.PaymentServiceImpl | Попытка списания 999.99 с кошелька пользователя inna
2025-03-06 17:18:51 | INFO  | r.k.stubService.PaymentServiceImpl | Успешное списание 999.99 с кошелька пользователя inna. Новый баланс: 0.01
2025-03-06 17:18:51 | INFO  | r.k.serviceImpl.RoleServiceImpl | Пользователь успешно приобрел роль SELLER
2025-03-06 17:18:51 | INFO  | r.k.controllers.RoleController | Роль BUYER успешно приобретена
2025-03-06 17:18:51 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/role/seller | RequestID=ef315ac8-d678-4aa7-b38b-8866501ba9b2 | Время=2025-03-06T14:18:51.723757Z | Длительность=150мс | Операция=PURCHASE_SELLER_ROLE | Статус=200
2025-03-06 17:20:17 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/products | RequestID=f750fbcf-88f0-4416-b068-46f17877b565 | Время=2025-03-06T14:20:17.774729Z | Операция=ADD_PRODUCT
2025-03-06 17:20:17 | INFO  | r.k.controllers.ProductController | Запрос на добавление товара
2025-03-06 17:20:17 | INFO  | r.k.serviceImpl.ProductServiceImpl | Создание нового товара
2025-03-06 17:20:18 | INFO  | r.k.serviceImpl.ProductServiceImpl | Товар с названием 'Зарядка на Iphone' успешно создан
2025-03-06 17:20:18 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/products | RequestID=f750fbcf-88f0-4416-b068-46f17877b565 | Время=2025-03-06T14:20:17.774729Z | Длительность=1128мс | Операция=ADD_PRODUCT | Статус=201
2025-03-06 17:20:34 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/logout | RequestID=f3e7d365-72d6-48c4-9bde-4ce899818037 | Время=2025-03-06T14:20:34.649986Z | Операция=LOGOUT_USER
2025-03-06 17:20:34 | INFO  | r.k.controllers.AuthController | Пользователь вышел из системы
2025-03-06 17:20:34 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/logout | RequestID=f3e7d365-72d6-48c4-9bde-4ce899818037 | Время=2025-03-06T14:20:34.649986Z | Длительность=6мс | Операция=LOGOUT_USER | Статус=200
2025-03-06 17:21:09 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/auth/login | RequestID=887dff71-5245-4ecd-b24f-f87997e9d00a | Время=2025-03-06T14:21:09.460938Z | Операция=LOGIN_USER
2025-03-06 17:21:09 | INFO  | r.k.serviceImpl.UserServiceImpl | Попытка входа пользователя:
2025-03-06 17:21:09 | INFO  | r.k.serviceImpl.UserServiceImpl | Успешный вход
2025-03-06 17:21:09 | INFO  | r.k.controllers.AuthController | Пользователь вошел в систему
2025-03-06 17:21:09 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/auth/login | RequestID=887dff71-5245-4ecd-b24f-f87997e9d00a | Время=2025-03-06T14:21:09.460938Z | Длительность=491мс | Операция=LOGIN_USER | Статус=200
2025-03-06 17:21:54 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/cart | RequestID=3688c7ee-68db-4d2f-b526-167238dff235 | Время=2025-03-06T14:21:54.900371Z | Операция=ADD_ITEM_TO_CART
2025-03-06 17:21:54 | INFO  | r.k.controllers.CartController | Запрос на добавление товара в корзину
2025-03-06 17:21:54 | INFO  | r.k.serviceImpl.CartServiceImpl | Запрос на добавление товара в корзину
2025-03-06 17:21:55 | INFO  | r.k.serviceImpl.CartServiceImpl | Товар добавлен в корзину
2025-03-06 17:21:55 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/cart | RequestID=3688c7ee-68db-4d2f-b526-167238dff235 | Время=2025-03-06T14:21:54.900371Z | Длительность=860мс | Операция=ADD_ITEM_TO_CART | Статус=200
2025-03-06 17:22:01 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/cart | RequestID=9f548aa7-c43f-455c-ae34-d2e4a9b3101e | Время=2025-03-06T14:22:01.026290Z | Операция=ADD_ITEM_TO_CART
2025-03-06 17:22:01 | INFO  | r.k.controllers.CartController | Запрос на добавление товара в корзину
2025-03-06 17:22:01 | INFO  | r.k.serviceImpl.CartServiceImpl | Запрос на добавление товара в корзину
2025-03-06 17:22:01 | INFO  | r.k.serviceImpl.CartServiceImpl | Товар добавлен в корзину
2025-03-06 17:22:01 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/cart | RequestID=9f548aa7-c43f-455c-ae34-d2e4a9b3101e | Время=2025-03-06T14:22:01.026290Z | Длительность=144мс | Операция=ADD_ITEM_TO_CART | Статус=200
2025-03-06 17:22:08 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/create | RequestID=d809565a-b30d-46cf-8758-3ad24571bbfb | Время=2025-03-06T14:22:08.823324Z | Операция=ORDER_CREATE
2025-03-06 17:22:08 | INFO  | r.k.controllers.OrderController | Запрос на создание заказа
2025-03-06 17:22:08 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка создать заказ
2025-03-06 17:22:09 | INFO  | r.k.serviceImpl.OrderServiceImpl | Заказ успешно создан
2025-03-06 17:22:09 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/create | RequestID=d809565a-b30d-46cf-8758-3ad24571bbfb | Время=2025-03-06T14:22:08.823324Z | Длительность=447мс | Операция=ORDER_CREATE | Статус=200
2025-03-06 17:22:36 | INFO  | r.k.l.RequestLoggingFilter | Запрос: POST /shop/orders/payment/20?addressId=1 | RequestID=3db4a6be-553c-455b-827c-156483bc6ccf | Время=2025-03-06T14:22:36.575734Z | Операция=PAYMENT_ORDER
2025-03-06 17:22:36 | INFO  | r.k.controllers.OrderController | Запрос на оплату заказа
2025-03-06 17:22:36 | INFO  | r.k.serviceImpl.OrderServiceImpl | Попытка оплатить заказ
2025-03-06 17:22:36 | INFO  | o.a.k.c.producer.ProducerConfig | ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = SberSchoolShop-producer-1
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-03-06 17:22:36 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 17:22:36 | INFO  | o.a.k.clients.producer.KafkaProducer | [Producer clientId=SberSchoolShop-producer-1] Instantiated an idempotent producer.
2025-03-06 17:22:37 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka version: 3.8.1
2025-03-06 17:22:37 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka commitId: 70d6ff42debf7e17
2025-03-06 17:22:37 | INFO  | o.a.kafka.common.utils.AppInfoParser | Kafka startTimeMs: 1741270957003
2025-03-06 17:22:37 | INFO  | org.apache.kafka.clients.Metadata | [Producer clientId=SberSchoolShop-producer-1] Cluster ID: 8qJM25-_Sz2H6XnzvywSlA
2025-03-06 17:22:37 | INFO  | o.a.k.c.p.i.TransactionManager | [Producer clientId=SberSchoolShop-producer-1] ProducerId set to 2 with epoch 0
2025-03-06 17:22:37 | INFO  | r.k.k.p.KafkaOrderEventPublisherImpl | Отправка email-уведомления в Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:22:37 | INFO  | o.a.k.c.producer.ProducerConfig | ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = SberSchoolShop-producer-1
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.springframework.kafka.support.serializer.JsonSerializer

2025-03-06 17:22:37 | INFO  | o.a.k.c.t.i.KafkaMetricsCollector | initializing Kafka metrics collector
2025-03-06 17:22:37 | INFO  | o.a.k.clients.producer.KafkaProducer | [Producer clientId=SberSchoolShop-producer-1] Instantiated an idempotent producer.
2025-03-06 17:22:37 | INFO  | o.a.kafka.common.utils.AppInfoParser | The mbean of App info: [kafka.producer], id: [SberSchoolShop-producer-1] already exists, so skipping a new mbean creation.
2025-03-06 17:22:37 | INFO  | org.apache.kafka.clients.Metadata | [Producer clientId=SberSchoolShop-producer-1] Cluster ID: 8qJM25-_Sz2H6XnzvywSlA
2025-03-06 17:22:37 | INFO  | o.a.k.c.p.i.TransactionManager | [Producer clientId=SberSchoolShop-producer-1] ProducerId set to 3 with epoch 0
2025-03-06 17:22:37 | INFO  | r.k.k.p.KafkaOrderEventPublisherImpl | Отправка email-уведомления в Kafka: EmailNotificationEvent(sellerEmail=innavesna.1978@gmail.com, productTitle=Зарядка на Iphone, quantity=3, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:22:37 | INFO  | r.k.serviceImpl.CartServiceImpl | Запрос на очищение корзины
2025-03-06 17:22:37 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=qwe.asd345921@yandex.ru, productTitle=Iphone, quantity=1, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:22:37 | INFO  | r.k.serviceImpl.CartServiceImpl | Корзина очищена
2025-03-06 17:22:37 | INFO  | r.k.l.RequestLoggingFilter | Ответ: POST /shop/orders/payment/20?addressId=1 | RequestID=3db4a6be-553c-455b-827c-156483bc6ccf | Время=2025-03-06T14:22:36.575734Z | Длительность=670мс | Операция=PAYMENT_ORDER | Статус=200
2025-03-06 17:22:37 | INFO  | r.k.k.c.InventoryEventListener | Обновлен остаток товара с id 7
2025-03-06 17:22:37 | INFO  | r.k.k.c.InventoryEventListener | Обновлен остаток товара с id 8
2025-03-06 17:22:39 | INFO  | r.k.k.consumers.EmailEventListener | Email-уведомление отправлено продавцу: qwe.asd345921@yandex.ru
2025-03-06 17:22:39 | INFO  | r.k.k.consumers.EmailEventListener | Получено email-уведомление из Kafka: EmailNotificationEvent(sellerEmail=innavesna.1978@gmail.com, productTitle=Зарядка на Iphone, quantity=3, address=Address(id=1, country=Russia, region=Rostov Oblast, city=Rostov don, street=Dovatora 135, zipCode=344000))
2025-03-06 17:22:41 | INFO  | r.k.k.consumers.EmailEventListener | Email-уведомление отправлено продавцу: innavesna.1978@gmail.com
2025-03-06 17:23:26 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node -1 disconnected.
2025-03-06 17:23:27 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node -1 disconnected.
2025-03-06 17:31:37 | INFO  | o.apache.kafka.clients.NetworkClient | [Producer clientId=SberSchoolShop-producer-1] Node -1 disconnected.
2025-03-06 17:31:37 | INFO  | o.apache.kafka.clients.NetworkClient | [Producer clientId=SberSchoolShop-producer-1] Node -1 disconnected.
2025-03-06 17:33:26 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-email-group-1, groupId=email-group] Node -1 disconnected.
2025-03-06 17:33:27 | INFO  | o.apache.kafka.clients.NetworkClient | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Node -1 disconnected.
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-email-group-1, groupId=email-group] Revoke previously assigned partitions email-notifications-0
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerRebalanceListenerInvoker | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Revoke previously assigned partitions inventory-updates-0
2025-03-06 17:34:55 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: partitions revoked: [email-notifications-0]
2025-03-06 17:34:55 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: partitions revoked: [inventory-updates-0]
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Member consumer-inventory-group-2-2c962cb8-f51e-4a8a-9dd8-2fed066e37c4 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Member consumer-email-group-1-37b27ca4-6656-4f29-93aa-f2c21a3bf7d5 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Unsubscribed all topics or patterns and assigned partitions
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.LegacyKafkaConsumer | [Consumer clientId=consumer-email-group-1, groupId=email-group] Unsubscribed all topics or patterns and assigned partitions
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-email-group-1, groupId=email-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 17:34:55 | INFO  | o.a.k.c.c.i.ConsumerCoordinator | [Consumer clientId=consumer-inventory-group-2, groupId=inventory-group] Request joining group due to: consumer pro-actively leaving the group
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.consumer for consumer-email-group-1 unregistered
2025-03-06 17:34:56 | INFO  | o.s.k.l.KafkaMessageListenerContainer | email-group: Consumer stopped
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.consumer for consumer-inventory-group-2 unregistered
2025-03-06 17:34:56 | INFO  | o.s.k.l.KafkaMessageListenerContainer | inventory-group: Consumer stopped
2025-03-06 17:34:56 | INFO  | o.s.b.w.e.tomcat.GracefulShutdown | Commencing graceful shutdown. Waiting for active requests to complete
2025-03-06 17:34:56 | INFO  | o.s.b.w.e.tomcat.GracefulShutdown | Graceful shutdown complete
2025-03-06 17:34:56 | INFO  | o.a.k.clients.producer.KafkaProducer | [Producer clientId=SberSchoolShop-producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.producer for SberSchoolShop-producer-1 unregistered
2025-03-06 17:34:56 | INFO  | o.a.k.clients.producer.KafkaProducer | [Producer clientId=SberSchoolShop-producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics scheduler closed
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.metrics.Metrics | Metrics reporters closed
2025-03-06 17:34:56 | INFO  | o.a.kafka.common.utils.AppInfoParser | App info kafka.producer for SberSchoolShop-producer-1 unregistered
2025-03-06 17:34:56 | INFO  | o.s.o.j.LocalContainerEntityManagerFactoryBean | Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-06 17:34:56 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown initiated...
2025-03-06 17:34:56 | INFO  | com.zaxxer.hikari.HikariDataSource | HikariPool-1 - Shutdown completed.
